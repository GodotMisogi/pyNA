from typing import Tuple
import pandas as pd
import openmdao.api as om
from julia.OpenMDAO import make_component
import julia.Main as julia
import numpy as np
import os
os.environ['pyna_language'] = 'julia'
from dataclasses import dataclass
import os
from pyNA.pyna import pyna
from pyNA.src.settings import Settings

# Load pyna data
pyna_settings = pyna.load_settings(case_name='stca')
py = pyna(pyna_settings)

# Load noise file
os.chdir('../../')
julia.include("src/noise_src_jl/noise_model.jl")

# Inputs
x = np.array([0.00000000e+00, 1.95951742e+01, 7.63620837e+01, 1.70300728e+02,
       2.99387763e+02, 4.61552485e+02, 6.56794894e+02, 8.83042920e+02,
       1.13824242e+03, 1.42239341e+03, 1.46702034e+03, 1.51223773e+03,
       1.55804557e+03, 1.60443723e+03, 1.65140614e+03, 1.69895229e+03,
       1.74706909e+03, 1.79575002e+03, 1.84499509e+03, 1.88532684e+03,
       1.92602772e+03, 1.96709775e+03, 2.00853835e+03, 2.05034341e+03,
       2.09251293e+03, 2.13504402e+03, 2.17791383e+03, 2.22112236e+03,
       2.23625796e+03, 2.25140482e+03, 2.26655305e+03, 2.28169842e+03,
       2.29684237e+03, 2.31198365e+03, 2.32712100e+03, 2.34225447e+03,
       2.35738442e+03, 2.37251148e+03, 2.38763378e+03, 2.40275268e+03,
       2.41786449e+03, 2.43296903e+03, 2.44806960e+03, 2.63940357e+03,
       2.83092632e+03, 3.02263785e+03, 3.21451209e+03, 3.40654645e+03,
       3.59874093e+03, 3.79109165e+03, 3.98359769e+03, 4.17625903e+03,
       4.36907460e+03, 4.56204374e+03, 4.75516643e+03, 4.94844200e+03,
       5.14186983e+03, 5.33544991e+03, 5.52918162e+03, 5.72306435e+03,
       5.91709810e+03, 6.11128226e+03, 6.30561623e+03, 6.50010000e+03,
       6.77739514e+03, 7.05499187e+03, 7.33288904e+03, 7.61108551e+03,
       7.88958012e+03, 8.16837176e+03, 8.44745927e+03, 8.72684153e+03,
       9.00651742e+03, 9.28648581e+03, 9.56674560e+03, 9.84729567e+03,
       1.01281349e+04, 1.04092622e+04, 1.06906765e+04, 1.09723767e+04,
       1.12543616e+04, 1.15366303e+04, 1.18191816e+04, 1.21020144e+04,
       1.23851277e+04, 1.26685204e+04, 1.29521915e+04, 1.32361399e+04,
       1.35203645e+04, 1.38048642e+04, 1.40896381e+04, 1.43746851e+04,
       1.46600041e+04, 1.49455942e+04, 1.52314542e+04, 1.55175832e+04,
       1.58039801e+04, 1.60906439e+04, 1.63775736e+04, 1.66647683e+04,
       1.69522267e+04, 1.72399481e+04, 1.75279313e+04, 1.78161754e+04,
       1.81046794e+04, 1.83934423e+04, 1.86824631e+04, 1.89717409e+04,
       1.92612745e+04, 1.95510632e+04, 1.98411059e+04, 2.01314016e+04,
       2.04219494e+04, 2.07127483e+04])
y = np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
z = np.array([ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
        0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
        0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
        0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
        0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
        0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
        0.00000000e+00,  0.00000000e+00,  0.00000000e+00, -4.97462829e-21,
        2.08525765e-02,  1.26221093e-01,  3.39839714e-01,  6.68020053e-01,
        1.09965118e+00,  1.63557172e+00,  2.27419218e+00,  3.01142731e+00,
        3.84276020e+00,  4.76324221e+00,  5.77413680e+00,  6.86818262e+00,
        8.05170790e+00,  9.32213892e+00,  1.06680000e+01,  2.76985939e+01,
        4.43995614e+01,  6.07709027e+01,  7.70402289e+01,  9.32140755e+01,
        1.09292443e+02,  1.25306247e+02,  1.41257126e+02,  1.57145079e+02,
        1.72974866e+02,  1.88747048e+02,  2.04461625e+02,  2.20119602e+02,
        2.35721370e+02,  2.51266928e+02,  2.66756730e+02,  2.82191137e+02,
        2.97570149e+02,  3.12894134e+02,  3.28163443e+02,  3.43378075e+02,
        3.64957272e+02,  3.86426900e+02,  4.07787620e+02,  4.29040087e+02,
        4.50184951e+02,  4.71222859e+02,  4.92154451e+02,  5.12980363e+02,
        5.33701226e+02,  5.54317667e+02,  5.74830307e+02,  5.95239763e+02,
        6.15546647e+02,  6.35751569e+02,  6.55855130e+02,  6.75857930e+02,
        6.95760563e+02,  7.15563619e+02,  7.35267685e+02,  7.54873341e+02,
        7.74381164e+02,  7.93791728e+02,  8.13105600e+02,  8.32323346e+02,
        8.51445525e+02,  8.70472694e+02,  8.89405405e+02,  9.08244206e+02,
        9.26989642e+02,  9.45642251e+02,  9.64202571e+02,  9.82671134e+02,
        1.00104847e+03,  1.01933510e+03,  1.03753155e+03,  1.05563835e+03,
        1.07365600e+03,  1.09158502e+03,  1.10942590e+03,  1.12717916e+03,
        1.14484529e+03,  1.16242478e+03,  1.17991812e+03,  1.19732581e+03,
        1.21464833e+03,  1.23188615e+03,  1.24903976e+03,  1.26610962e+03,
        1.28309621e+03,  1.30000000e+03])
alpha = np.array([-0.85      , -0.85      , -0.85      , -0.85      , -0.85      ,
       -0.85      , -0.85      , -0.85      , -0.85      , -0.85      ,
       -0.85      , -0.85      , -0.85      , -0.85      , -0.85      ,
       -0.85      , -0.85      , -0.85      , -0.85      ,  0.41105438,
        1.67210876,  2.93316314,  4.19421752,  5.4552719 ,  6.71632628,
        7.97738066,  9.23843504, 10.49948942, 15.04347354, 15.99375899,
       15.78254647, 15.64052901, 15.59689196, 15.47742591, 15.38392587,
       15.11552943, 14.8141426 , 14.9644398 , 14.78436046, 14.51445873,
       14.9079915 , 14.68832767, 10.5489482 , 10.63914569, 10.69916125,
       10.72899489, 10.74177316, 10.75062264, 10.75554332, 10.7582165 ,
       10.76032349, 10.76186427, 10.7630782 , 10.76420462, 10.76524353,
       10.7662297 , 10.76719786, 10.76814804, 10.76908537, 10.77001503,
       10.770937  , 10.77185207, 10.77276103, 10.77366386, 10.77494002,
       10.77620451, 10.77745756, 10.77869937, 10.77993009, 10.78114983,
       10.78235872, 10.78355687, 10.78474441, 10.78592149, 10.78708824,
       10.78824473, 10.78939109, 10.79052744, 10.79165392, 10.79277062,
       10.79387766, 10.79497512, 10.79606312, 10.79714179, 10.79821123,
       10.79927152, 10.80032277, 10.80136507, 10.80239854, 10.80342329,
       10.8044394 , 10.80544693, 10.80644601, 10.80743677, 10.80841916,
       10.80939344, 10.81035994, 10.81131865, 10.81226922, 10.81321161,
       10.81414621, 10.81507308, 10.81599231, 10.81690406, 10.8178084 ,
       10.81870539, 10.81959512, 10.82047766, 10.82135311, 10.82222154,
       10.823083  , 10.8239376 , 10.82478537, 10.82562638])
gamma = np.array([0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.20420493, 0.60181382,
       1.03414004, 1.43532576, 1.83234193, 2.22213628, 2.6061125 ,
       2.97100251, 3.31511098, 3.64831535, 3.98921555, 4.29887881,
       4.63917607, 4.97541099, 5.17631993, 5.02228692, 4.91949963,
       4.86795803, 4.82872734, 4.79644083, 4.7710985 , 4.74759967,
       4.72519399, 4.70388143, 4.68293359, 4.66224104, 4.64180379,
       4.6215153 , 4.60135861, 4.58133372, 4.56142409, 4.54162629,
       4.52194032, 4.50236282, 4.48289226, 4.46352864, 4.43612747,
       4.40893828, 4.38195885, 4.35518709, 4.32862098, 4.30225852,
       4.27609773, 4.25013664, 4.22437331, 4.19880581, 4.1734323 ,
       4.1482509 , 4.12325975, 4.09845702, 4.0738409 , 4.04940965,
       4.02516149, 4.00109468, 3.97720748, 3.9534982 , 3.92996516,
       3.90660672, 3.88342121, 3.86040701, 3.8375625 , 3.8148861 ,
       3.79237627, 3.77003142, 3.74785002, 3.72583055, 3.70397152,
       3.68227135, 3.66072892, 3.63934304, 3.61811241, 3.59703516,
       3.57610969, 3.55533453, 3.53470824, 3.51422943, 3.49389677,
       3.47370894, 3.4536646 , 3.43376245, 3.41400123, 3.39437967,
       3.37489652, 3.35555056, 3.33634055, 3.31726528])
c_0 = np.array([346.15651388, 346.15651388, 346.15651388, 346.15651388,
       346.15651388, 346.15651388, 346.15651388, 346.15651388,
       346.15651388, 346.15651388, 346.15651388, 346.15651388,
       346.15651388, 346.15651388, 346.15651388, 346.15651388,
       346.15651388, 346.15651388, 346.15651388, 346.15651388,
       346.15651388, 346.15651388, 346.15651388, 346.15651388,
       346.15651388, 346.15651388, 346.15651388, 346.15651388,
       346.1564352 , 346.15603764, 346.15523164, 346.15399338,
       346.15236478, 346.15034268, 346.14793306, 346.14515133,
       346.14201452, 346.1385413 , 346.1347269 , 346.13059868,
       346.12613278, 346.12133888, 346.11626028, 346.05198888,
       345.98895018, 345.92714419, 345.86571247, 345.80463055,
       345.74389843, 345.68339959, 345.623128  , 345.56308367,
       345.5032488 , 345.44362141, 345.3842015 , 345.32498544,
       345.26597191, 345.20716091, 345.14855087, 345.09014058,
       345.03193004, 344.97391802, 344.91610333, 344.85848597,
       344.77674971, 344.69540923, 344.61446231, 344.53390674,
       344.45374034, 344.37396091, 344.29456631, 344.21555439,
       344.13692301, 344.05867005, 343.98079342, 343.90329103,
       343.8261608 , 343.74940067, 343.67300861, 343.59698257,
       343.52132055, 343.44602053, 343.37108053, 343.29649857,
       343.22227269, 343.14840095, 343.0748814 , 343.00171211,
       342.9288912 , 342.85641674, 342.78428687, 342.71249971,
       342.6410534 , 342.5699461 , 342.49917596, 342.42874118,
       342.35863994, 342.28887044, 342.21943087, 342.15031947,
       342.08153445, 342.01307409, 341.94493663, 341.87712036,
       341.80962357, 341.74244455, 341.67558162, 341.6090331 ,
       341.54279732, 341.47687262, 341.41125737, 341.34594992,
       341.28094866, 341.21625196])
T_0 = np.array([298.1669    , 298.1669    , 298.1669    , 298.1669    ,
       298.1669    , 298.1669    , 298.1669    , 298.1669    ,
       298.1669    , 298.1669    , 298.1669    , 298.1669    ,
       298.1669    , 298.1669    , 298.1669    , 298.1669    ,
       298.1669    , 298.1669    , 298.1669    , 298.1669    ,
       298.1669    , 298.1669    , 298.1669    , 298.1669    ,
       298.1669    , 298.1669    , 298.1669    , 298.1669    ,
       298.16676446, 298.16607956, 298.16469104, 298.16255787,
       298.15975227, 298.15626878, 298.15211775, 298.14732572,
       298.14192206, 298.13593893, 298.12936811, 298.12225681,
       298.1145639 , 298.1063061 , 298.097558  , 297.98685914,
       297.87830285, 297.77188913, 297.66613851, 297.56100851,
       297.45649912, 297.35240939, 297.24872868, 297.14545699,
       297.04256337, 296.94004419, 296.83789944, 296.73612259,
       296.6347111 , 296.53366497, 296.43298125, 296.33265761,
       296.23269403, 296.13308813, 296.03383762, 295.93494251,
       295.79467773, 295.65512515, 295.51628047, 295.37813943,
       295.24069782, 295.10395141, 294.96789607, 294.83252764,
       294.69784203, 294.56383516, 294.43050301, 294.29784154,
       294.16584679, 294.0345148 , 293.90384166, 293.77382346,
       293.64445634, 293.51573647, 293.38766005, 293.26022328,
       293.13342243, 293.00725377, 292.8817136 , 292.75679825,
       292.63250409, 292.50882749, 292.38576487, 292.26331266,
       292.14146733, 292.02022537, 291.89958329, 291.77953763,
       291.66008496, 291.54122185, 291.4229449 , 291.30525073,
       291.188136  , 291.0715974 , 290.95563164, 290.84023547,
       290.72540564, 290.61113895, 290.4974322 , 290.38428222,
       290.27168587, 290.15964002, 290.04814158, 289.93718747,
       289.82677462, 289.7169    ])
t_s = np.array([  0.        ,   2.98381868,   5.96763736,   8.95145604,
        11.93527472,  14.9190934 ,  17.90291208,  20.88673076,
        23.87054944,  26.85436812,  27.29881257,  27.74325701,
        28.18770146,  28.6321459 ,  29.07659035,  29.52103479,
        29.96547924,  30.40992368,  30.85436812,  31.21466938,
        31.57497063,  31.93527188,  32.29557313,  32.65587438,
        33.01617563,  33.37647688,  33.73677814,  34.09707939,
        34.22272892,  34.34837846,  34.474028  ,  34.59967753,
        34.72532707,  34.85097661,  34.97662614,  35.10227568,
        35.22792521,  35.35357475,  35.47922429,  35.60487382,
        35.73052336,  35.8561729 ,  35.98182243,  37.57260794,
        39.16339345,  40.75417896,  42.34496447,  43.93574998,
        45.52653549,  47.117321  ,  48.70810651,  50.29889202,
        51.88967753,  53.48046303,  55.07124854,  56.66203405,
        58.25281956,  59.84360507,  61.43439058,  63.02517609,
        64.6159616 ,  66.20674711,  67.79753262,  69.38831813,
        71.65435574,  73.92039336,  76.18643098,  78.4524686 ,
        80.71850622,  82.98454383,  85.25058145,  87.51661907,
        89.78265669,  92.0486943 ,  94.31473192,  96.58076954,
        98.84680716, 101.11284477, 103.37888239, 105.64492001,
       107.91095763, 110.17699525, 112.44303286, 114.70907048,
       116.9751081 , 119.24114572, 121.50718333, 123.77322095,
       126.03925857, 128.30529619, 130.5713338 , 132.83737142,
       135.10340904, 137.36944666, 139.63548428, 141.90152189,
       144.16755951, 146.43359713, 148.69963475, 150.96567236,
       153.23170998, 155.4977476 , 157.76378522, 160.02982283,
       162.29586045, 164.56189807, 166.82793569, 169.09397331,
       171.36001092, 173.62604854, 175.89208616, 178.15812378,
       180.42416139, 182.69019901])
mu_0 = np.array([1.83733457e-05, 1.83733457e-05, 1.83733457e-05, 1.83733457e-05,
       1.83733457e-05, 1.83733457e-05, 1.83733457e-05, 1.83733457e-05,
       1.83733457e-05, 1.83733457e-05, 1.83733457e-05, 1.83733457e-05,
       1.83733457e-05, 1.83733457e-05, 1.83733457e-05, 1.83733457e-05,
       1.83733457e-05, 1.83733457e-05, 1.83733457e-05, 1.83733457e-05,
       1.83733457e-05, 1.83733457e-05, 1.83733457e-05, 1.83733457e-05,
       1.83733457e-05, 1.83733457e-05, 1.83733457e-05, 1.83733457e-05,
       1.83733393e-05, 1.83733068e-05, 1.83732409e-05, 1.83731396e-05,
       1.83730065e-05, 1.83728412e-05, 1.83726441e-05, 1.83724167e-05,
       1.83721602e-05, 1.83718762e-05, 1.83715644e-05, 1.83712268e-05,
       1.83708617e-05, 1.83704697e-05, 1.83700545e-05, 1.83647995e-05,
       1.83596454e-05, 1.83545920e-05, 1.83495693e-05, 1.83445752e-05,
       1.83396097e-05, 1.83346634e-05, 1.83297356e-05, 1.83248264e-05,
       1.83199344e-05, 1.83150594e-05, 1.83102014e-05, 1.83053601e-05,
       1.83005353e-05, 1.82957271e-05, 1.82909354e-05, 1.82861600e-05,
       1.82814010e-05, 1.82766583e-05, 1.82719317e-05, 1.82672212e-05,
       1.82605390e-05, 1.82538892e-05, 1.82472716e-05, 1.82406861e-05,
       1.82341324e-05, 1.82276104e-05, 1.82211199e-05, 1.82146607e-05,
       1.82082327e-05, 1.82018357e-05, 1.81954695e-05, 1.81891339e-05,
       1.81828288e-05, 1.81765540e-05, 1.81703093e-05, 1.81640946e-05,
       1.81579097e-05, 1.81517544e-05, 1.81456286e-05, 1.81395321e-05,
       1.81334648e-05, 1.81274264e-05, 1.81214169e-05, 1.81154361e-05,
       1.81094837e-05, 1.81035598e-05, 1.80976640e-05, 1.80917963e-05,
       1.80859565e-05, 1.80801445e-05, 1.80743600e-05, 1.80686031e-05,
       1.80628734e-05, 1.80571708e-05, 1.80514953e-05, 1.80458466e-05,
       1.80402247e-05, 1.80346293e-05, 1.80290604e-05, 1.80235177e-05,
       1.80180012e-05, 1.80125107e-05, 1.80070461e-05, 1.80016072e-05,
       1.79961939e-05, 1.79908061e-05, 1.79854436e-05, 1.79801063e-05,
       1.79747940e-05, 1.79695067e-05])
rho_0 = np.array([1.18385805, 1.18385805, 1.18385805, 1.18385805, 1.18385805,
       1.18385805, 1.18385805, 1.18385805, 1.18385805, 1.18385805,
       1.18385805, 1.18385805, 1.18385805, 1.18385805, 1.18385805,
       1.18385805, 1.18385805, 1.18385805, 1.18385805, 1.18385805,
       1.18385805, 1.18385805, 1.18385805, 1.18385805, 1.18385805,
       1.18385805, 1.18385805, 1.18385805, 1.18385566, 1.18384359,
       1.18381912, 1.18378153, 1.18373209, 1.1836707 , 1.18359756,
       1.18351312, 1.18341791, 1.1833125 , 1.18319675, 1.18307148,
       1.18293598, 1.18279054, 1.18263649, 1.18068839, 1.17878031,
       1.17691225, 1.17505805, 1.17321694, 1.1713889 , 1.16957037,
       1.16776112, 1.16596115, 1.16416988, 1.16238721, 1.16061315,
       1.15884753, 1.15709029, 1.15534141, 1.15360082, 1.15186844,
       1.15014427, 1.14842824, 1.14672026, 1.14502035, 1.14261263,
       1.14022098, 1.13784527, 1.13548536, 1.13314111, 1.1308124 ,
       1.12849909, 1.12620106, 1.12391817, 1.12165031, 1.11939734,
       1.11715914, 1.11493559, 1.11272656, 1.11053195, 1.10835162,
       1.10618546, 1.10403335, 1.10189519, 1.09977085, 1.09766022,
       1.09556319, 1.09347965, 1.09140949, 1.0893526 , 1.08730888,
       1.08527822, 1.08326051, 1.08125565, 1.07926354, 1.07728407,
       1.07531715, 1.07336267, 1.07142054, 1.06949066, 1.06757292,
       1.06566724, 1.06377352, 1.06189166, 1.06002158, 1.05816318,
       1.05631636, 1.05448105, 1.05265715, 1.05084456, 1.04904321,
       1.04725301, 1.04547387, 1.0437057 , 1.04194842])
TS = np.array([1.   , 1.   , 1.   , 1.   , 1.   , 1.   , 1.   , 1.   , 1.   ,
       1.   , 1.   , 1.   , 1.   , 1.   , 1.   , 1.   , 1.   , 1.   ,
       1.   , 1.   , 1.   , 1.   , 1.   , 1.   , 1.   , 1.   , 1.   ,
       1.   , 1.   , 1.   , 1.   , 1.   , 1.   , 1.   , 1.   , 1.   ,
       1.   , 1.   , 1.   , 1.   , 1.   , 1.   , 0.475, 0.475, 0.475,
       0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475,
       0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475,
       0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475,
       0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475,
       0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475,
       0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475,
       0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475, 0.475,
       0.475, 0.475, 0.475, 0.475, 0.475, 0.475])
M_0 = np.array([0.        , 0.03729176, 0.07328061, 0.10796653, 0.1413251 ,
       0.17335017, 0.20404177, 0.23339385, 0.26142403, 0.28813229,
       0.29199897, 0.2958369 , 0.29964609, 0.30342665, 0.30717868,
       0.31090219, 0.3145973 , 0.31826412, 0.32190266, 0.32485465,
       0.32781439, 0.33078187, 0.33373666, 0.33665889, 0.33954859,
       0.34240358, 0.34511942, 0.34769611, 0.34819298, 0.34829913,
       0.34829645, 0.34831554, 0.34833572, 0.34834798, 0.34835095,
       0.34837524, 0.34842546, 0.34848029, 0.34849815, 0.34855612,
       0.34854522, 0.34852602, 0.3487286 , 0.3490878 , 0.34944066,
       0.34978718, 0.35012603, 0.35046335, 0.35079913, 0.35113331,
       0.3514666 , 0.35179902, 0.35213056, 0.35246132, 0.35279129,
       0.35312049, 0.35344893, 0.35377661, 0.35410352, 0.35442968,
       0.35475509, 0.35507974, 0.35540364, 0.35572678, 0.3561858 ,
       0.3566433 , 0.35709928, 0.35755376, 0.35800672, 0.35845818,
       0.35890814, 0.3593566 , 0.35980357, 0.36024904, 0.36069303,
       0.36113554, 0.36157656, 0.36201611, 0.36245419, 0.3628908 ,
       0.36332595, 0.36375963, 0.36419185, 0.36462262, 0.36505194,
       0.36547981, 0.36590623, 0.36633122, 0.36675477, 0.36717688,
       0.36759757, 0.36801683, 0.36843467, 0.36885109, 0.36926609,
       0.36967968, 0.37009187, 0.37050265, 0.37091203, 0.37132001,
       0.3717266 , 0.3721318 , 0.37253561, 0.37293804, 0.3733391 ,
       0.37373877, 0.37413708, 0.37453401, 0.37492958, 0.37532379,
       0.37571664, 0.37610814, 0.37649829, 0.37688709])
I_0 = np.array([409.79813483, 409.79813483, 409.79813483, 409.79813483,
       409.79813483, 409.79813483, 409.79813483, 409.79813483,
       409.79813483, 409.79813483, 409.79813483, 409.79813483,
       409.79813483, 409.79813483, 409.79813483, 409.79813483,
       409.79813483, 409.79813483, 409.79813483, 409.79813483,
       409.79813483, 409.79813483, 409.79813483, 409.79813483,
       409.79813483, 409.79813483, 409.79813483, 409.79813483,
       409.79721482, 409.79256603, 409.78314145, 409.76866289,
       409.74962092, 409.72597907, 409.69780808, 409.66528887,
       409.62862148, 409.58802504, 409.54344475, 409.49520181,
       409.44301829, 409.38700876, 409.32768036, 408.57753269,
       407.84292767, 407.12386529, 406.41026858, 405.70183012,
       404.99854993, 404.29905015, 403.60324184, 402.91112501,
       402.22247442, 401.53724919, 400.85544932, 400.17701475,
       399.50191262, 398.83014294, 398.1616702 , 397.49646339,
       396.8345225 , 396.17581622, 395.52031443, 394.86801711,
       393.94430664, 393.02698075, 392.11598314, 391.21125815,
       390.31275073, 389.42040644, 388.53417142, 387.65399243,
       386.77981678, 385.91159238, 385.04926769, 384.19279175,
       383.34211412, 382.49718493, 381.65795484, 380.82437504,
       379.99639724, 379.17397368, 378.3570571 , 377.54560074,
       376.73955835, 375.93888417, 375.14353292, 374.3534598 ,
       373.56862049, 372.78897113, 372.01446831, 371.24506911,
       370.48073102, 369.72141201, 368.96707046, 368.21766522,
       367.47315551, 366.73350095, 365.99866151, 365.26859758,
       364.54327007, 363.82264032, 363.10667004, 362.39532139,
       361.68855688, 360.98633943, 360.28863233, 359.59539923,
       358.90660417, 358.22221155, 357.54218611, 356.86649297,
       356.19509757, 355.52796572])
p_0 = np.array([101325.        , 101325.        , 101325.        , 101325.        ,
       101325.        , 101325.        , 101325.        , 101325.        ,
       101325.        , 101325.        , 101325.        , 101325.        ,
       101325.        , 101325.        , 101325.        , 101325.        ,
       101325.        , 101325.        , 101325.        , 101325.        ,
       101325.        , 101325.        , 101325.        , 101325.        ,
       101325.        , 101325.        , 101325.        , 101325.        ,
       101324.74949256, 101323.48368086, 101320.91748255, 101316.97515485,
       101311.79029458, 101305.35298338, 101297.68250505, 101288.8281506 ,
       101278.84441231, 101267.79098375, 101255.6529778 , 101242.51788547,
       101228.31006843, 101213.06076357, 101196.90808304, 100992.69477091,
       100792.74856005, 100597.06945045, 100402.9122893 , 100210.19262989,
       100018.91047222,  99828.69008466,  99639.50659401,  99451.36000027,
        99264.18836719,  99077.97993428,  98892.73470155,  98708.43569628,
        98525.07336593,  98342.6477105 ,  98161.14845978,  97980.56657925,
        97800.90206893,  97622.14582089,  97444.28906253,  97267.33179384,
        97016.79559531,  96768.05032673,  96521.07961613,  96275.86728004,
        96032.39732352,  95790.65393086,  95550.62146562,  95312.28446929,
        95075.62765732,  94840.63591909,  94607.29431272,  94375.58806241,
        94145.50255899,  93917.02335584,  93690.13616884,  93464.82687161,
        93241.08149342,  93018.88621929,  92798.22738633,  92579.09148373,
        92361.46514833,  92145.3351628 ,  91930.68845557,  91717.51209748,
        91505.79330173,  91295.51942018,  91086.67794081,  90879.25648863,
        90673.24282196,  90468.62483246,  90265.39053985,  90063.52810005,
        89863.02578448,  89663.8719758 ,  89466.05516791,  89269.56398359,
        89074.38719003,  88880.51367923,  88687.9324636 ,  88496.63267605,
        88306.6035645 ,  88117.83448905,  87930.31492305,  87744.03444979,
        87558.98276251,  87375.14966102,  87192.52505113,  87011.09894342,
        86830.86145154,  86651.80279214])

mdoti_c = np.array([32.00774   , 32.03572095, 32.11216737, 32.23707927, 32.40310897,
       32.60341537, 32.83799844, 33.09852689, 33.37935903, 33.68049486,
       33.72659047, 33.77299152, 33.819698  , 33.86671404, 33.91399987,
       33.96155548, 34.00936111, 34.05739897, 34.10566908, 34.14526582,
       34.18536186, 34.22595719, 34.26677595, 34.30752661, 34.34820917,
       34.38878074, 34.42769247, 34.46494437, 34.47208161, 34.47322568,
       34.47237898, 34.47141403, 34.47007348, 34.46822337, 34.46584952,
       34.4634124 , 34.46099653, 34.45831048, 34.45474497, 34.45144826,
       34.44681226, 34.44172719, 22.89365103, 22.85517973, 22.81750814,
       22.78063625, 22.74397225, 22.70757481, 22.67144393, 22.63550011,
       22.59974729, 22.56418546, 22.52880174, 22.49359515, 22.4585657 ,
       22.42371002, 22.38902654, 22.35451524, 22.3201742 , 22.28600179,
       22.25199799, 22.21816113, 22.18448959, 22.15098339, 22.10353678,
       22.05641937, 22.00962814, 21.96316016, 21.91701249, 21.87118226,
       21.82566663, 21.78046279, 21.73556795, 21.6909794 , 21.64669443,
       21.60271037, 21.55902458, 21.51563447, 21.47253748, 21.42973105,
       21.3872127 , 21.34497995, 21.30303035, 21.2613615 , 21.21997101,
       21.17885653, 21.13801574, 21.09744634, 21.05714606, 21.01711267,
       20.97734394, 20.9378377 , 20.89859178, 20.85960405, 20.82087206,
       20.7823932 , 20.74417247, 20.70620892, 20.66849567, 20.63102809,
       20.5938041 , 20.55682166, 20.52007872, 20.48357327, 20.44730332,
       20.41126691, 20.37546208, 20.33988691, 20.30453951, 20.269418  ,
       20.23452052, 20.19984523, 20.16539033, 20.13115401])
Tti_c = np.array([727.80348   , 727.99641522, 728.52148299, 729.3786833 ,
       730.5141092 , 731.87646383, 733.46574719, 735.22096461,
       737.10024246, 739.10358074, 739.40903763, 739.71621747,
       740.02512027, 740.33595212, 740.64826039, 740.96204509,
       741.27715259, 741.5934569 , 741.91095803, 742.17115707,
       742.43439904, 742.70068392, 742.96818841, 743.23500211,
       743.501125  , 743.7662733 , 744.02035909, 744.26338237,
       744.31010849, 744.31851137, 744.31490294, 744.31154989,
       744.30667374, 744.29940838, 744.28964673, 744.28035468,
       744.27204272, 744.26276596, 744.24856134, 744.23685298,
       744.21720554, 744.19540429, 635.67843471, 635.48335317,
       635.29210032, 635.10467616, 634.91785116, 634.7321853 ,
       634.54767857, 634.36386868, 634.18081856, 633.99852821,
       633.81693163, 633.6360325 , 633.45583083, 633.27631295,
       633.09747538, 632.91931812, 632.74183519, 632.56502216,
       632.38887902, 632.21340097, 632.03858354, 631.86442674,
       631.61747585, 631.3718477 , 631.12753377, 630.88452566,
       630.642815  , 630.40239352, 630.16325301, 629.92538532,
       629.6887824 , 629.45343624, 629.21933892, 628.98648255,
       628.75485935, 628.52446157, 628.29528154, 628.06731165,
       627.84054435, 627.61497215, 627.39058762, 627.16738341,
       626.9453522 , 626.72448673, 626.50477983, 626.28622435,
       626.06881322, 625.85253942, 625.63739599, 625.42337601,
       625.21047263, 624.99867906, 624.78798752, 624.57838961,
       624.36990085, 624.16251765, 623.95621733, 623.75098504,
       623.54681418, 623.34369806, 623.14163009, 622.94060376,
       622.74061263, 622.54165033, 622.34371056, 622.1467871 ,
       621.95087379, 621.75596454, 621.56205333, 621.36913419,
       621.17720125, 620.98624867])
Ttj_c = np.array([1882.74609   , 1883.20160822, 1884.45100582, 1886.49428282,
       1889.219324  , 1892.45627661, 1896.20514065, 1900.37409828,
       1904.83586793, 1909.5904496 , 1910.31554864, 1911.04478715,
       1911.77816515, 1912.51670867, 1913.25881362, 1914.00447999,
       1914.75329275, 1915.50493998, 1916.2594217 , 1916.87771569,
       1917.50321266, 1918.1359126 , 1918.77147326, 1919.40534818,
       1920.03753737, 1920.66735869, 1921.27085189, 1921.84801696,
       1921.95899813, 1921.97903126, 1921.9706201 , 1921.9629005 ,
       1921.95164047, 1921.93478394, 1921.9120755 , 1921.89055535,
       1921.87143242, 1921.85008442, 1921.81710141, 1921.79010785,
       1921.74432875, 1921.69349972, 1526.26426682, 1525.88378031,
       1525.51076708, 1525.14522715, 1524.78052936, 1524.4181294 ,
       1524.05802726, 1523.69918362, 1523.34180361, 1522.98588722,
       1522.63130779, 1522.27808894, 1521.92623067, 1521.57571397,
       1521.22654119, 1520.87871234, 1520.53222344, 1520.18707321,
       1519.84326164, 1519.50078631, 1519.15964489, 1518.81983736,
       1518.33808697, 1517.85903164, 1517.38266484, 1516.90897948,
       1516.43796781, 1515.96962154, 1515.50393178, 1515.04088909,
       1514.58048349, 1514.12270448, 1513.667541  , 1513.21498149,
       1512.7650139 , 1512.31762574, 1511.87280402, 1511.43053531,
       1510.99080573, 1510.55360103, 1510.11890654, 1509.68670722,
       1509.25698766, 1508.82973208, 1508.40492442, 1507.98254827,
       1507.56258695, 1507.14502348, 1506.72984063, 1506.31702091,
       1505.90654664, 1505.49839989, 1505.09257648, 1504.68908167,
       1504.28759196, 1503.88803436, 1503.49058645, 1503.09534408,
       1502.70229344, 1502.3114219 , 1501.92271697, 1501.53616633,
       1501.15175774, 1500.76947912, 1500.38931851, 1500.01126406,
       1499.63530407, 1499.2614269 , 1498.88962107, 1498.51987517,
       1498.15217794, 1497.7865182 ])
Pti_c = np.array([2034191.48744   , 2036220.06433555, 2041762.1806586 ,
       2050817.83640914, 2062870.37164236, 2077403.06050013,
       2094415.90298244, 2113350.40749017, 2133784.50230653,
       2155718.18743153, 2159078.36670217, 2162461.51035047,
       2165867.61837642, 2169297.3599669 , 2172747.49981239,
       2176218.03791288, 2179707.51103744, 2183214.62327402,
       2186739.37462262, 2189631.28566788, 2192560.1238129 ,
       2195525.88905768, 2198508.44192084, 2201486.47137592,
       2204459.97742289, 2207425.81940161, 2210270.7068666 ,
       2212994.63981784, 2213516.83260501, 2213601.83254549,
       2213542.62452648, 2213476.22103168, 2213383.6621414 ,
       2213255.16336587, 2213089.66767991, 2212920.79594888,
       2212754.67155069, 2212569.92037584, 2212322.004251  ,
       2212094.79909744, 2211770.79715814, 2211415.06003639,
       1309976.96817338, 1307612.63065299, 1305297.75173011,
       1303032.33140474, 1300779.63430073, 1298543.63511081,
       1296324.33383497, 1294116.73610048, 1291921.14263205,
       1289737.55342969, 1287565.16941535, 1285403.93508702,
       1283253.85044473, 1281114.70725078, 1278986.40664594,
       1276868.9486302 , 1274762.21273432, 1272666.09616685,
       1270580.59892778, 1268505.61540922, 1266441.04457888,
       1264386.88643675, 1261478.5593826 , 1258590.9651678 ,
       1255723.91472123, 1252877.22114322, 1250050.69970549,
       1247244.16775718, 1244457.44473366, 1241690.35218314,
       1238942.71368641, 1236214.35485679, 1233505.10322202,
       1230814.7882497 , 1228143.24138889, 1225490.29597988,
       1222855.78725416, 1220239.55224434, 1217641.42979606,
       1215061.26060414, 1212498.88713352, 1209954.15361929,
       1207426.90598235, 1204916.99184891, 1202424.26056744,
       1199948.56314747, 1197489.75225966, 1195047.68216715,
       1192622.208699  , 1190213.18934195, 1187820.48312054,
       1185443.95059709, 1183083.44166843, 1180738.79965579,
       1178410.15353304, 1176097.40775864, 1173800.24227562,
       1171518.42686308, 1169251.82980614, 1167000.31953205,
       1164763.76610281, 1162542.04121521, 1160335.01803188,
       1158142.57122531, 1155964.57700367, 1153800.91302857,
       1151651.45841499, 1149516.09367589, 1147394.70074152,
       1145287.1629178 , 1143193.36488839, 1141113.19271471])
DTt_des_c = np.array([1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055, 1195.95055,
       1195.95055, 1195.95055, 1195.95055, 1195.95055])

V_j = np.array([408.25766   , 408.62025521, 409.59838849, 411.19205986,
       413.30182368, 415.8069485 , 418.70743434, 421.89808729,
       425.28824863, 428.87791836, 429.42263647, 429.96976728,
       430.51931081, 431.07140366, 431.62545046, 432.18145119,
       432.73914668, 433.29831387, 433.85895275, 434.31793583,
       434.78185123, 435.25069893, 435.72125444, 436.19016702,
       436.65743667, 437.12256922, 437.56793337, 437.99352911,
       438.07578264, 438.09282203, 438.09123235, 438.09262605,
       438.09364292, 438.09278572, 438.08983198, 438.08988238,
       438.09373044, 438.09786257, 438.09537053, 438.09908757,
       438.09088947, 438.08084483, 311.76840965, 311.77558705,
       311.78275955, 311.78992713, 311.79598333, 311.80210987,
       311.80830675, 311.81444019, 311.82064856, 311.82693188,
       311.8332712 , 311.83968488, 311.84617293, 311.85273169,
       311.85936292, 311.86606661, 311.87284135, 311.8796865 ,
       311.88660204, 311.89358688, 311.90064008, 311.90776162,
       311.91802203, 311.92841709, 311.93894486, 311.94960343,
       311.96039086, 311.97130523, 311.98234462, 311.99350714,
       312.00479089, 312.01619398, 312.02771451, 312.0393506 ,
       312.05110037, 312.06296195, 312.07493348, 312.08701307,
       312.09919887, 312.11148903, 312.12388169, 312.136375  ,
       312.14896713, 312.16165623, 312.17444047, 312.18731803,
       312.2002871 , 312.21334586, 312.2264925 , 312.23972522,
       312.25304224, 312.26644179, 312.27992309, 312.2934861 ,
       312.30710689, 312.32077969, 312.33451689, 312.34832508,
       312.36220292, 312.37614917, 312.39016263, 312.40424215,
       312.41838658, 312.43259483, 312.44686581, 312.46119851,
       312.47559192, 312.49004506, 312.50455697, 312.51912675,
       312.53375352, 312.5484364 ])
rho_j = np.array([0.82859   , 0.82858021, 0.82854078, 0.82847171, 0.82837808,
       0.82826458, 0.82813121, 0.82798256, 0.82782262, 0.82765138,
       0.82762524, 0.82759894, 0.82757248, 0.82754564, 0.82751867,
       0.82749157, 0.82746437, 0.8274371 , 0.82740974, 0.82738736,
       0.82736474, 0.82734188, 0.82731896, 0.82729613, 0.8272734 ,
       0.8272508 , 0.82722918, 0.82720854, 0.82720291, 0.82719378,
       0.82717703, 0.8271511 , 0.82711704, 0.82707486, 0.82702468,
       0.82696659, 0.82690091, 0.8268282 , 0.82674869, 0.82666234,
       0.82656952, 0.82646996, 0.92133993, 0.91983898, 0.91836885,
       0.91692952, 0.91550081, 0.91408211, 0.91267345, 0.91127211,
       0.90987793, 0.90849089, 0.90711055, 0.90573683, 0.90436973,
       0.90300914, 0.90165498, 0.90030727, 0.89896592, 0.8976309 ,
       0.89630218, 0.89497973, 0.89366346, 0.8923534 , 0.89049783,
       0.88865461, 0.88682364, 0.88500481, 0.88319801, 0.88140315,
       0.87962011, 0.87784881, 0.87608914, 0.874341  , 0.8726043 ,
       0.87087894, 0.86916483, 0.86746186, 0.86576995, 0.86408902,
       0.86241895, 0.86075968, 0.85911111, 0.85747314, 0.8558457 ,
       0.85422871, 0.85262206, 0.85102569, 0.84943951, 0.84786344,
       0.8462974 , 0.8447413 , 0.84319507, 0.84165863, 0.84013191,
       0.83861479, 0.83710739, 0.83560965, 0.83412138, 0.83264246,
       0.8311728 , 0.82971234, 0.828261  , 0.82681871, 0.82538539,
       0.82396098, 0.8225454 , 0.82113859, 0.81974047, 0.81835097,
       0.81697003, 0.81559758, 0.81423356, 0.81287789])
A_j = np.array([0.61933   , 0.61933062, 0.6193262 , 0.61931674, 0.61931227,
       0.61935512, 0.61944528, 0.61959576, 0.6198239 , 0.62012971,
       0.62018275, 0.62023771, 0.6202946 , 0.6203534 , 0.62041412,
       0.62047676, 0.62054131, 0.62060777, 0.62067613, 0.62073338,
       0.62079245, 0.62085333, 0.62091565, 0.62097896, 0.62104325,
       0.62110845, 0.62117192, 0.62123365, 0.62124571, 0.62124829,
       0.62124823, 0.62124869, 0.62124917, 0.62124947, 0.62124953,
       0.62125012, 0.62125133, 0.62125266, 0.62125308, 0.62125449,
       0.62125421, 0.62125373, 0.61931999, 0.61932   , 0.61932   ,
       0.61932   , 0.61932   , 0.61932001, 0.61932001, 0.61932002,
       0.61932002, 0.61932003, 0.61932003, 0.61932004, 0.61932004,
       0.61932005, 0.61932005, 0.61932006, 0.61932006, 0.61932007,
       0.61932007, 0.61932007, 0.61932008, 0.61932008, 0.61932009,
       0.61932009, 0.6193201 , 0.6193201 , 0.6193201 , 0.6193201 ,
       0.6193201 , 0.6193201 , 0.6193201 , 0.6193201 , 0.6193201 ,
       0.6193201 , 0.6193201 , 0.61932009, 0.61932009, 0.61932008,
       0.61932008, 0.61932007, 0.61932006, 0.61932006, 0.61932005,
       0.61932004, 0.61932004, 0.61932003, 0.61932002, 0.61932001,
       0.61932001, 0.61932   , 0.61931999, 0.61931998, 0.61931998,
       0.61931997, 0.61931997, 0.61931997, 0.61931998, 0.61931998,
       0.61931999, 0.61932   , 0.61932001, 0.61932002, 0.61932003,
       0.61932005, 0.61932006, 0.61932007, 0.61932009, 0.6193201 ,
       0.61932012, 0.61932013, 0.61932015, 0.61932017])
Tt_j = np.array([506.97413   , 507.12214838, 507.5274095 , 508.18991336,
       509.07499645, 510.1334254 , 511.36520021, 512.72972696,
       514.19115348, 515.74947979, 515.987176  , 516.22623782,
       516.46666523, 516.70873676, 516.95198305, 517.19640409,
       517.44186894, 517.68827641, 517.93562652, 518.13833978,
       518.3434257 , 518.55088427, 518.75929292, 518.96716134,
       519.17448953, 519.38105445, 519.5789963 , 519.76831509,
       519.80471659, 519.81127152, 519.80847897, 519.80589529,
       519.80213405, 519.79652064, 519.78897154, 519.78179679,
       519.77539367, 519.7682467 , 519.7572689 , 519.74824284,
       519.73304041, 519.71616782, 430.41303601, 430.26686276,
       430.12355515, 429.98311319, 429.84324505, 429.70424533,
       429.56611403, 429.42851328, 429.29147898, 429.15501112,
       429.01906322, 428.88363708, 428.7487327 , 428.61434104,
       428.48046009, 428.34708984, 428.21422667, 428.08186801,
       427.95001384, 427.81866132, 427.68780778, 427.5574532 ,
       427.3726221 , 427.18879264, 427.00595956, 426.82411754,
       426.64326127, 426.4633854 , 426.28448457, 426.10655341,
       425.92958652, 425.75357848, 425.57852388, 425.40441727,
       425.23125319, 425.05902617, 424.88773074, 424.7173614 ,
       424.54791265, 424.37937899, 424.21175491, 424.04503487,
       423.87921337, 423.71428488, 423.55024386, 423.38708479,
       423.22480215, 423.06339042, 422.90284407, 422.74315759,
       422.58432548, 422.42634223, 422.26920301, 422.11290342,
       421.95742391, 421.80275594, 421.64890206, 421.49586212,
       421.34363107, 421.19220394, 421.0415758 , 420.89174177,
       420.74269703, 420.59443681, 420.44695639, 420.3002511 ,
       420.15431631, 420.00914744, 419.86473996, 419.72108937,
       419.57819123, 419.43604115])
M_j = np.array([0.99019   , 0.99106595, 0.99341726, 0.99724394, 1.00230448,
       1.0083146 , 1.01527431, 1.02292503, 1.03105175, 1.03965448,
       1.04095959, 1.04227041, 1.04358692, 1.04490915, 1.04623599,
       1.04756742, 1.04890286, 1.05024178, 1.05158418, 1.05268315,
       1.05379392, 1.05491648, 1.05604311, 1.05716581, 1.05828457,
       1.05939821, 1.06046453, 1.06148352, 1.0616807 , 1.06172277,
       1.06172153, 1.06172882, 1.06173645, 1.06174085, 1.06174147,
       1.06175046, 1.06176969, 1.06179066, 1.06179687, 1.06181894,
       1.06181356, 1.0618048 , 0.79663969, 0.79681036, 0.79697818,
       0.79714313, 0.7973044 , 0.79746508, 0.79762515, 0.79778459,
       0.79794374, 0.79810262, 0.79826121, 0.79841956, 0.79857767,
       0.79873555, 0.79889319, 0.79905059, 0.79920776, 0.7993647 ,
       0.7995214 , 0.79967786, 0.79983408, 0.79999006, 0.80021184,
       0.80043314, 0.80065394, 0.80087424, 0.80109405, 0.80131337,
       0.80153218, 0.80175049, 0.80196829, 0.80218559, 0.80240238,
       0.80261866, 0.80283442, 0.80304967, 0.80326441, 0.80347863,
       0.80369232, 0.8039055 , 0.80411815, 0.80433028, 0.80454188,
       0.80475295, 0.8049635 , 0.80517351, 0.80538299, 0.80559194,
       0.80580035, 0.80600822, 0.80621556, 0.80642236, 0.80662862,
       0.80683435, 0.80703947, 0.80724398, 0.80744791, 0.80765129,
       0.80785413, 0.80805643, 0.80825817, 0.80845937, 0.80866003,
       0.80886014, 0.80905971, 0.80925873, 0.80945721, 0.80965515,
       0.80985256, 0.81004942, 0.81024574, 0.81044153])

DTt_f = np.array([69.36586   , 69.38608191, 69.43996455, 69.52750792, 69.64579744,
       69.78719344, 69.95169592, 70.13397072, 70.3290192 , 70.53684135,
       70.56855412, 70.60045295, 70.63253786, 70.66487426, 70.69737214,
       70.7300315 , 70.76283247, 70.79576108, 70.82881732, 70.85590892,
       70.88331787, 70.91104418, 70.93889736, 70.96667789, 70.99438577,
       71.02199087, 71.04844267, 71.07374119, 71.0786053 , 71.07948085,
       71.07910696, 71.0787606 , 71.07825653, 71.07750461, 71.07649369,
       71.07553245, 71.07467399, 71.07371583, 71.07224548, 71.07103562,
       71.06900022, 71.06674135, 38.73447373, 38.72280581, 38.71136876,
       38.70016258, 38.68898257, 38.67787889, 38.66685153, 38.65586356,
       38.64492249, 38.63402834, 38.62317673, 38.61236817, 38.60160267,
       38.5908793 , 38.58019784, 38.5695583 , 38.55896025, 38.54840339,
       38.53788773, 38.52741292, 38.51697865, 38.50658492, 38.49184867,
       38.47719345, 38.46261869, 38.4481238 , 38.43370821, 38.41937137,
       38.4051127 , 38.39093167, 38.37682771, 38.3628003 , 38.34884889,
       38.33497296, 38.32117198, 38.30744543, 38.2937928 , 38.28021357,
       38.26670723, 38.25327329, 38.23991124, 38.2266206 , 38.21340087,
       38.20025157, 38.18717221, 38.17416232, 38.16122143, 38.14834906,
       38.13554474, 38.12280802, 38.11013844, 38.09753553, 38.08499896,
       38.07252846, 38.06012127, 38.0477765 , 38.03549514, 38.02327761,
       38.01112352, 37.99903249, 37.98700416, 37.97503816, 37.96313415,
       37.95129177, 37.93951069, 37.92779058, 37.91613111, 37.90453197,
       37.89299283, 37.88151341, 37.87009339, 37.85873249])
mdot_f = np.array([210.3812    , 210.56273382, 211.05425777, 211.85577186,
       212.91526086, 214.18803122, 215.67408295, 217.32780776,
       219.10971138, 221.01979381, 221.31206045, 221.60623469,
       221.90231653, 222.20018695, 222.49973835, 222.80097072,
       223.10377301, 223.40803663, 223.71376158, 223.96454949,
       224.21849963, 224.47561198, 224.73414203, 224.99224587,
       225.24992352, 225.50690565, 225.75338256, 225.98935426,
       226.03456079, 226.04178139, 226.03636379, 226.03016812,
       226.02156692, 226.00971145, 225.99451226, 225.9788873 ,
       225.96337311, 225.94612483, 225.92328241, 225.90212175,
       225.87245419, 225.83991981, 178.75568101, 178.46879337,
       178.18785857, 177.91287663, 177.63930145, 177.36769301,
       177.0980513 , 176.82977938, 176.56291904, 176.29747027,
       176.03333584, 175.77051091, 175.5089955 , 175.248765  ,
       174.98980841, 174.73212573, 174.47570313, 174.22052896,
       173.96660324, 173.71391394, 173.4624496 , 173.21221021,
       172.85784172, 172.50591385, 172.15640513, 171.80929432,
       171.46456043, 171.12218272, 170.78214067, 170.444414  ,
       170.10898267, 169.77582686, 169.44492697, 169.11626362,
       168.78981765, 168.46557011, 168.14350226, 167.82359559,
       167.50583176, 167.19019265, 166.87666034, 166.56521711,
       166.25584543, 165.94852795, 165.64324752, 165.33998718,
       165.03873016, 164.73945984, 164.44215981, 164.14681382,
       163.8534058 , 163.56191986, 163.27233829, 162.98464228,
       162.69885893, 162.41497937, 162.13295878, 161.8527662 ,
       161.57438641, 161.29780414, 161.0230043 , 160.749972  ,
       160.47869247, 160.20915114, 159.94133359, 159.67522558,
       159.410813  , 159.14808192, 158.88701855, 158.62760927,
       158.36984057, 158.11369915])
N_f = np.array([3419.83905   , 3420.34214019, 3421.67983641, 3423.85213865,
       3426.69520143, 3430.10890204, 3434.09324048, 3438.48155979,
       3443.17235075, 3448.16561336, 3448.92685126, 3449.69236722,
       3450.46216124, 3451.23735848, 3452.0162354 , 3452.79879201,
       3453.58459223, 3454.37331112, 3455.16494867, 3455.81365207,
       3456.46987705, 3457.13362361, 3457.80033608, 3458.46524671,
       3459.1283555 , 3459.78894803, 3460.42189896, 3461.02720828,
       3461.14358304, 3461.16451448, 3461.15553523, 3461.14719653,
       3461.13506819, 3461.1169933 , 3461.0927051 , 3461.06958989,
       3461.0489188 , 3461.02584786, 3460.99050737, 3460.96138626,
       3460.91249673, 3460.858246  , 2652.44404258, 2652.1108563 ,
       2651.78434302, 2651.46450273, 2651.14340016, 2650.8242411 ,
       2650.50702553, 2650.19088664, 2649.87613677, 2649.56277592,
       2649.25065184, 2648.93980095, 2648.63022324, 2648.32188624,
       2648.01478517, 2647.70892002, 2647.40427614, 2647.10084321,
       2646.79862121, 2646.49759844, 2646.19776425, 2645.89911864,
       2645.47573517, 2645.05472131, 2644.6360572 , 2644.21972333,
       2643.80570049, 2643.3939698 , 2642.98451267, 2642.57731087,
       2642.17234645, 2641.76960175, 2641.36905935, 2640.97070209,
       2640.5745131 , 2640.18047577, 2639.78857369, 2639.3987907 ,
       2639.01111085, 2638.62551842, 2638.24199792, 2637.86053407,
       2637.48111175, 2637.10371606, 2636.7283323 , 2636.35494595,
       2635.98354268, 2635.61410833, 2635.24662891, 2634.8810906 ,
       2634.51747977, 2634.15578295, 2633.79598787, 2633.43808323,
       2633.08203214, 2632.72781585, 2632.37543378, 2632.02488209,
       2631.67614892, 2631.32922261, 2630.98409181, 2630.64074543,
       2630.29917258, 2629.95936264, 2629.62130524, 2629.28499023,
       2628.95040771, 2628.61754799, 2628.28640159, 2627.95695927,
       2627.62921199, 2627.30315096])
A_f = np.array([0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032,
       0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032,
       0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032,
       0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032,
       0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032,
       0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032,
       0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032,
       0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032,
       0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032,
       0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032,
       0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032,
       0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032,
       0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032,
       0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032, 0.7032,
       0.7032, 0.7032])
d_f = np.array([1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948,
       1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948,
       1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948,
       1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948,
       1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948,
       1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948,
       1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948,
       1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948,
       1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948,
       1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948,
       1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948,
       1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948,
       1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948,
       1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948, 1.1948,
       1.1948, 1.1948])

I_landing_gear = np.array([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
       1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
       1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
theta_flaps = np.array([10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10.,
       10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10.,
       10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10.,
       10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10.,
       10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10.,
       10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10.,
       10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10.,
       10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10., 10.,
       10., 10., 10., 10., 10., 10., 10., 10., 10., 10.])

# Observer location
n_t = 10
n1 = 50
n2 = 60
objective = 'noise'
idx = py.noise.get_input_vector_indices(py.settings, n_t)

# Create problem
prob = om.Problem()
comp = make_component(julia.NoiseModel(py.settings, py.noise.data, py.ac, n_t, idx, objective))
prob.model.add_subsystem("g", comp)
prob.setup(force_alloc_complex=True)

prob.set_val('g.x', x[n1:n2])
prob.set_val('g.y', y[n1:n2])
prob.set_val('g.z', z[n1:n2])
prob.set_val('g.alpha', alpha[n1:n2])
prob.set_val('g.gamma', gamma[n1:n2])
prob.set_val('g.t_s', t_s[n1:n2])
prob.set_val('g.rho_0', rho_0[n1:n2])
prob.set_val('g.mu_0', mu_0[n1:n2])
prob.set_val('g.c_0', c_0[n1:n2])
prob.set_val('g.T_0', T_0[n1:n2])
prob.set_val('g.p_0', p_0[n1:n2])
prob.set_val('g.M_0', M_0[n1:n2])
prob.set_val('g.I_0', I_0[n1:n2])
prob.set_val('g.TS', TS[n1:n2])

if py.settings.jet_mixing == True and py.settings.jet_shock == False:
       prob.set_val('g.V_j', V_j[n1:n2])
       prob.set_val('g.rho_j', rho_j[n1:n2])
       prob.set_val('g.A_j', A_j[n1:n2])
       prob.set_val('g.Tt_j', Tt_j[n1:n2])
elif py.settings.jet_shock == True and py.settings.jet_mixing == False:
       prob.set_val('g.V_j', V_j[n1:n2])
       prob.set_val('g.A_j', A_j[n1:n2])
       prob.set_val('g.Tt_j', Tt_j[n1:n2])
       prob.set_val('g.M_j', M_j[n1:n2])
elif py.settings.jet_shock ==True and py.settings.jet_mixing == True:
       prob.set_val('g.V_j', V_j[n1:n2])
       prob.set_val('g.rho_j', rho_j[n1:n2])
       prob.set_val('g.A_j', A_j[n1:n2])
       prob.set_val('g.Tt_j', Tt_j[n1:n2])
       prob.set_val('g.M_j', M_j[n1:n2])
    
if py.settings.core:
       if py.settings.method_core_turb == "GE":
              prob.set_val('g.mdoti_c', mdoti_c[n1:n2])
              prob.set_val('g.Tti_c', Tti_c[n1:n2])
              prob.set_val('g.Ttj_c', Ttj_c[n1:n2])
              prob.set_val('g.Pti_c', Pti_c[n1:n2])
              prob.set_val('g.DTt_des_c', DTt_des_c[n1:n2])

if py.settings.airframe:
       prob.set_val('g.theta_flaps', theta_flaps[n1:n2])
       prob.set_val('g.I_landing_gear', I_landing_gear[n1:n2])

if py.settings.fan_inlet==True or py.settings.fan_discharge==True:
       prob.set_val('g.DTt_f', DTt_f[n1:n2])
       prob.set_val('g.mdot_f', mdot_f[n1:n2])
       prob.set_val('g.N_f', N_f[n1:n2])
       prob.set_val('g.A_f', A_f[n1:n2])
       prob.set_val('g.d_f', d_f[n1:n2])

# Run the geomtry model
prob.run_model()

# Check partials 
prob.check_partials(compact_print=True, method='fd')
