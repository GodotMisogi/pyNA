<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="ioaspl" href="ioaspl.html" /><link rel="prev" title="geometry" href="geometry.html" />

    <meta name="generator" content="sphinx-3.1.1, furo 2020.12.30.beta24"/>
        <title>ground reflections - pyNA 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/styles/furo.css?digest=33d2fc4f3f180ec1ffc6524e273e21d7d58cbe49">
    <link rel="stylesheet" href="_static/pygments.css">
    <link media="(prefers-color-scheme: dark)" rel="stylesheet" href="_static/pygments_dark.css">
    


<style>
  :root {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }

  /* For allowing end-user-specific overrides */
  .override-light {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  .override-dark {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
</style><link rel="stylesheet" href="_static/styles/furo-extensions.css?digest=26485485040e7aaf717c13fd0188a5ad2c2deb60">
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script defer="defer" src="_static/jquery.js"></script>
    <script defer="defer" src="_static/underscore.js"></script>
    <script defer="defer" src="_static/doctools.js"></script>
    <script defer="defer" src="_static/language_data.js"></script>
    <script async="async" defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script defer src="_static/scripts/main.js?digest=e931d09b2a40c1bb82b542effe772014573baf67"></script></head>
  <body dir="">
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z"/>
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">pyNA 1.0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">pyNA 1.0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html">
  <input class="sidebar-search" placeholder=Search name="q">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how_to_use.html">how to use pyNA?</a></li>
<li class="toctree-l1"><a class="reference internal" href="methods.html">methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="openmdao.html">openmdao</a></li>
<li class="toctree-l1"><a class="reference internal" href="partials.html">partials</a></li>
</ul>
<p class="caption"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="help!.html">help!</a></li>
</ul>
<p class="caption"><span class="caption-text">pyNA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="aircraft.html">aircraft</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">data</a></li>
<li class="toctree-l1"><a class="reference internal" href="emissions.html">emissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="engine.html">engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="noise.html">noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="settings.html">settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="trajectory.html">trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyNA.html">pyna</a></li>
</ul>
<p class="caption"><span class="caption-text">Noise</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="airframe.html">airframe</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">core</a></li>
<li class="toctree-l1"><a class="reference internal" href="epnl.html">epnl</a></li>
<li class="toctree-l1"><a class="reference internal" href="fan.html">fan</a></li>
<li class="toctree-l1"><a class="reference internal" href="geometry.html">geometry</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">ground reflections</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioaspl.html">ioaspl</a></li>
<li class="toctree-l1"><a class="reference internal" href="ipnlt.html">ipnlt</a></li>
<li class="toctree-l1"><a class="reference internal" href="jet.html">jet</a></li>
<li class="toctree-l1"><a class="reference internal" href="lateral_attenuation.html">lateral attenuation</a></li>
<li class="toctree-l1"><a class="reference internal" href="levels_int.html">levels_int</a></li>
<li class="toctree-l1"><a class="reference internal" href="levels.html">levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="noise.html">noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="noise_model.html">noise_model</a></li>
<li class="toctree-l1"><a class="reference internal" href="normalization_engine_variables.html">normalization_engine_variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="oaspl.html">oaspl</a></li>
<li class="toctree-l1"><a class="reference internal" href="pnlt.html">pnlt</a></li>
<li class="toctree-l1"><a class="reference internal" href="propagation.html">propagation</a></li>
<li class="toctree-l1"><a class="reference internal" href="shielding.html">shielding</a></li>
<li class="toctree-l1"><a class="reference internal" href="source.html">source</a></li>
<li class="toctree-l1"><a class="reference internal" href="spl.html">spl</a></li>
<li class="toctree-l1"><a class="reference internal" href="split_subbands.html">split subbands</a></li>
</ul>
<p class="caption"><span class="caption-text">Trajectory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="aerodynamics.html">aerodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="atmosphere.html">atmosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="clcd.html">clcd</a></li>
<li class="toctree-l1"><a class="reference internal" href="flight_dynamics.html">flight_dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="mux.html">mux</a></li>
<li class="toctree-l1"><a class="reference internal" href="propulsion.html">propulsion</a></li>
<li class="toctree-l1"><a class="reference internal" href="trajectory.html">trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="trajectory_ode.html">trajectory_ode</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <main class="main">
    <div class="content">
      <article role="main">
        <label class="toc-overlay-icon toc-content-icon" for="__toc">
          <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
        </label>
        <div class="section" id="ground-reflections">
<h1>ground reflections<a class="headerlink" href="#ground-reflections" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-ground_reflections">
<span id="class-description"></span><h2>class description<a class="headerlink" href="#module-ground_reflections" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="ground_reflections.ground_reflections">
<code class="sig-prename descclassname">ground_reflections.</code><code class="sig-name descname">ground_reflections</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">settings</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>Any<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">pyNA.src.data.Data</span></em>, <em class="sig-param"><span class="n">r</span><span class="p">:</span> <span class="n">numpy.float64</span></em>, <em class="sig-param"><span class="n">beta</span><span class="p">:</span> <span class="n">numpy.float64</span></em>, <em class="sig-param"><span class="n">x_obs</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">c_bar</span><span class="p">:</span> <span class="n">numpy.float64</span></em>, <em class="sig-param"><span class="n">rho_0</span><span class="p">:</span> <span class="n">numpy.float64</span></em><span class="sig-paren">)</span> → numpy.ndarray<a class="reference internal" href="_modules/ground_reflections.html#ground_reflections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ground_reflections.ground_reflections" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the ground reflection coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>settings</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – pyna settings</p></li>
<li><p><strong>data</strong> (<a class="reference internal" href="data.html#data.Data" title="data.Data"><em>Data</em></a>) – pyna noise data</p></li>
<li><p><strong>r</strong> (<em>np.float64</em>) – distance source to observer [m]</p></li>
<li><p><strong>beta</strong> (<em>np.float64</em>) – elevation angle [deg]</p></li>
<li><p><strong>x_obs</strong> (<em>np.ndarray</em>) – observer location [m, m, m]</p></li>
<li><p><strong>c_bar</strong> (<em>np.float64</em>) – average ambient speed of sound between observer and source [m/s]</p></li>
<li><p><strong>rho_0</strong> (<em>np.float64</em>) – ambient density [kg/m3]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>G</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>
</div>
<div class="section" id="theory">
<h2>theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ground-absorption-and-reflection-effects">
<h3>Ground absorption and reflection effects}<a class="headerlink" href="#ground-absorption-and-reflection-effects" title="Permalink to this headline">¶</a></h3>
<p>The Chien-Soroka method is used to assess ground reflections and ground attenuation. The method accounts for the amplification and attenuation of noise when two signals, the direct and reflected signal, arrive at the microphone with a phase shift. Firstly, the path length of the reflected signal is computed:</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[r_r = \sqrt{r^2 + 4 z_{\textrm{obs}}^2 + 4rz_{\textrm{obs}}\sin\beta}\]</div></div>
<p>where <span class="math notranslate nohighlight">\(\beta\)</span> is the elevation angle of the source at the observer. The difference between the direct and the reflected wave path is denoted by <span class="math notranslate nohighlight">\(\Delta r = r_r - r\)</span>. The wavenumber, <span class="math notranslate nohighlight">\(k\)</span>, and dimensionless frequency, <span class="math notranslate nohighlight">\(\eta\)</span>,  of the sound wave are computed using:</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
k &amp;= \frac{2\pi f_{sb}}{\bar{c}} \\
\eta &amp;= \frac{2\pi \rho_0 f_{sb}}{\sigma}
\end{aligned}\end{split}\]</div></div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is the specific flow resistance of ground. The cosine of the incidence angle of the reflected signal is:</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[\cos \theta = \frac{r \sin \beta + 2  z_{\textrm{obs}}}{r_r}\]</div></div>
<p>The empirical complex specific ground admittance, <span class="math notranslate nohighlight">\(\nu\)</span>, is computed using:</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[\nu = \frac{1}{\left[ 1 + (6.86\eta)^{-0.75}\right] + (4.36 \eta)^{-0.73} j}\]</div></div>
<p>where <span class="math notranslate nohighlight">\(j\)</span> denotes the imaginary unit. The complex spherical wave reflection coefficient, <span class="math notranslate nohighlight">\(Z\)</span>, is computed using:</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[Z = \Gamma + (1-\Gamma)F\]</div></div>
<p>where:</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    \Gamma &amp;= \frac{\cos \theta - \nu}{\cos \theta + \nu} \\
    F &amp;= -2 \sqrt{\pi} U[-Re(\tau)] \tau \exp(\tau^2) + \frac{1}{2\tau^2} - \frac{3}{(2\tau^2)^2}
\end{aligned}\end{split}\]</div></div>
<p>The coefficient <span class="math notranslate nohighlight">\(\tau\)</span> is given by:</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[\tau = (\cos \theta + \nu) \sqrt{\frac{k r_r}{2j}}\]</div></div>
<p>and the unit step function, <span class="math notranslate nohighlight">\(U\)</span>, is given by:</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[\begin{split}U =
\begin{cases}
1 \quad &amp; \textrm{if} \quad -\textrm{Re}(\tau) &gt; 0 \\
1/2 \quad &amp; \textrm{if}\quad -\textrm{Re}(\tau) = 0 \\
0 \quad &amp; \textrm{if}\quad -\textrm{Re}(\tau) &lt; 0 \\
\end{cases}\end{split}\]</div></div>
<p>The ground reflection factor, <span class="math notranslate nohighlight">\(G\)</span>, is computed using:</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[G = 1 + R^2 + 2R\exp\left(-(a_{coh} k \Delta r) ^ 2\right) \cos(\alpha + k \Delta r) \frac{\sin(\epsilon  k  \Delta r)}{\epsilon k \Delta r}\]</div></div>
<p>where <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> are the magnitude and angle of the complex spherical wave reflection coefficient, i.e. <span class="math notranslate nohighlight">\(R \exp(\alpha j) = Z\)</span>. The constants <span class="math notranslate nohighlight">\(K\)</span> and <span class="math notranslate nohighlight">\(\epsilon\)</span> are given by:</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
K &amp;= 2^{1/(6N_b)} \\
\epsilon &amp;= K - 1 \\
\end{aligned}\end{split}\]</div></div>
<p>Finally, the ground absorption and reflection effects are applied to the mean-square acoustic pressure of each sub-band <span class="math notranslate nohighlight">\(j\)</span> using:</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[&lt;p^2_{\textrm{ground-effects}}&gt;_j \ = G &lt;p^2_{\textrm{absorb}}&gt;_j\]</div></div>
</div>
</div>
</div>

      </article>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="ioaspl.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">ioaspl</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="geometry.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">geometry</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Laurens Voet
            |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            |
            <a class="muted-link" href="_sources/ground_reflections.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">ground reflections</a><ul>
<li><a class="reference internal" href="#module-ground_reflections">class description</a></li>
<li><a class="reference internal" href="#theory">theory</a><ul>
<li><a class="reference internal" href="#ground-absorption-and-reflection-effects">Ground absorption and reflection effects}</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </main>
</div>
  </body>
</html>