<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <meta name="generator" content="sphinx-3.1.1, furo 2020.12.30.beta24"/>
        <title>pyNA.pyna - pyNA 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../_static/styles/furo.css?digest=33d2fc4f3f180ec1ffc6524e273e21d7d58cbe49">
    <link rel="stylesheet" href="../../_static/pygments.css">
    <link media="(prefers-color-scheme: dark)" rel="stylesheet" href="../../_static/pygments_dark.css">
    


<style>
  :root {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }

  /* For allowing end-user-specific overrides */
  .override-light {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  .override-dark {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
</style><link rel="stylesheet" href="../../_static/styles/furo-extensions.css?digest=26485485040e7aaf717c13fd0188a5ad2c2deb60">
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script defer="defer" src="../../_static/jquery.js"></script>
    <script defer="defer" src="../../_static/underscore.js"></script>
    <script defer="defer" src="../../_static/doctools.js"></script>
    <script defer="defer" src="../../_static/language_data.js"></script>
    <script async="async" defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script defer src="../../_static/scripts/main.js?digest=e931d09b2a40c1bb82b542effe772014573baf67"></script></head>
  <body dir="">
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z"/>
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">pyNA 1.0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">pyNA 1.0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html">
  <input class="sidebar-search" placeholder=Search name="q">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption"><span class="caption-text">Main</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../how_to_use.html">how to use pyNA?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../methods.html">methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../openmdao.html">openmdao</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../partials.html">partials</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../example_noise_time_series.html">Computing a noise time series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example_noise_contours.html">Computing noise contours</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example_noise_epnl_table.html">Computing a noise EPNL table</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example_noise_source_distribution.html">Computing noise source distributions</a></li>
</ul>
<p class="caption"><span class="caption-text">pyNA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../aircraft.html">aircraft</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data.html">data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../emissions.html">emissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../engine.html">engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../noise.html">noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../settings.html">settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trajectory.html">trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pyNA.html">pyna</a></li>
</ul>
<p class="caption"><span class="caption-text">Noise</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../airframe.html">airframe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../core.html">core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../epnl.html">epnl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fan.html">fan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../geometry.html">geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ground_reflections.html">ground reflections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ioaspl.html">ioaspl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ipnlt.html">ipnlt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jet.html">jet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lateral_attenuation.html">lateral attenuation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../levels_int.html">levels_int</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../levels.html">levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../noise.html">noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../noise_model.html">noise_model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../normalization_engine_variables.html">normalization_engine_variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../oaspl.html">oaspl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pnlt.html">pnlt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../propagation.html">propagation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../shielding.html">shielding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source.html">source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../spl.html">spl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../split_subbands.html">split subbands</a></li>
</ul>
<p class="caption"><span class="caption-text">Trajectory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../aerodynamics.html">aerodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../atmosphere.html">atmosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../clcd.html">clcd</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../flight_dynamics.html">flight_dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mux.html">mux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../propulsion.html">propulsion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trajectory.html">trajectory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trajectory_ode.html">trajectory_ode</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <main class="main">
    <div class="content">
      <article role="main">
        <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
          <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
        </label>
        <h1>Source code for pyNA.pyna</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pdb</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">import</span> <span class="nn">openmdao.api</span> <span class="k">as</span> <span class="nn">om</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.inset_locator</span> <span class="kn">import</span> <span class="n">zoomed_inset_axes</span><span class="p">,</span> <span class="n">mark_inset</span>
<span class="kn">from</span> <span class="nn">pyNA.src.settings</span> <span class="kn">import</span> <span class="n">Settings</span>
<span class="kn">from</span> <span class="nn">pyNA.src.aircraft</span> <span class="kn">import</span> <span class="n">Aircraft</span>
<span class="kn">from</span> <span class="nn">pyNA.src.engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">pyNA.src.trajectory</span> <span class="kn">import</span> <span class="n">Trajectory</span>
<span class="kn">from</span> <span class="nn">pyNA.src.noise</span> <span class="kn">import</span> <span class="n">Noise</span>

<div class="viewcode-block" id="pyna"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna">[docs]</a><span class="k">class</span> <span class="nc">pyna</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    The pyna module contains the methods to assess the noise footprint of an aircraft (i.e airframe and engine) flying</span>
<span class="sd">    along a predefined trajectory and calculates the sensitivities of the noise footprint with respect to engine</span>
<span class="sd">    variables.</span>
<span class="sd">    """</span>

<div class="viewcode-block" id="pyna.__init__"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings</span><span class="p">:</span> <span class="n">Settings</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Initialize pyna class.</span>

<span class="sd">        :param settings: pyna settings</span>
<span class="sd">        :type settings: Settings</span>

<span class="sd">        :return: None</span>

<span class="sd">        """</span>

        <span class="c1"># Set pyNA settings class and check</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>

        <span class="c1"># Settings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">language</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'pyna_language'</span><span class="p">]</span>

        <span class="c1"># Initialize trajectory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="n">n_segments_vnrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">n_segments_vnrs</span><span class="p">)</span>

        <span class="c1"># Initialize noise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="o">=</span> <span class="n">Noise</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>

        <span class="c1"># Initialize aircraft configuration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ac</span> <span class="o">=</span> <span class="n">Aircraft</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">ac_name</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">ac_version</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>
        
        <span class="c1"># Initialize engine configuration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">()</span>

        <span class="c1"># Initialize openmdao problems</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">problem_init</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">()</span></div>

<div class="viewcode-block" id="pyna.load_settings"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.load_settings">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">load_settings</span><span class="p">(</span><span class="n">case_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Settings</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Load default pyna settings.</span>

<span class="sd">        :param case_name: name of the case to load</span>
<span class="sd">        :type case_name: str</span>

<span class="sd">        :return: pyna settings</span>
<span class="sd">        :rtype: Settings</span>
<span class="sd">        """</span>

        <span class="k">return</span> <span class="n">Settings</span><span class="p">(</span><span class="n">case_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="pyna.compute_trajectory"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.compute_trajectory">[docs]</a>    <span class="k">def</span> <span class="nf">compute_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_optimization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">objective</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Compute aircraft take-off trajectory.</span>

<span class="sd">        :return: converged</span>
<span class="sd">        :rtype: bool </span>

<span class="sd">        """</span>

        <span class="c1"># Load aircraft and engine deck</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">load_aerodynamics</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">compute_characteristic_speeds</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">load_deck</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>

        <span class="c1"># Create trajectory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">coloring_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/cases/'</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">case_name</span> <span class="o">+</span> <span class="s1">'/output/coloring_files/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">,</span> <span class="n">engine_mode</span><span class="o">=</span><span class="s1">'trajectory'</span><span class="p">,</span> <span class="n">control_optimization</span><span class="o">=</span><span class="n">control_optimization</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">,</span> <span class="n">run_driver</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">init_trajectory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">control_optimization</span><span class="o">=</span><span class="n">control_optimization</span><span class="p">,</span> <span class="n">objective</span><span class="o">=</span><span class="n">objective</span><span class="p">)</span>

        <span class="c1"># Check convergence</span>
        <span class="n">converged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">check_convergence</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">'IPOPT_trajectory_convergence.out'</span><span class="p">)</span>

        <span class="c1"># # If not converged, rerun the trajectory with slight perturbation in the controls</span>
        <span class="c1"># if not converged:</span>
        <span class="c1">#     self.problem = om.Problem(coloring_dir=self.settings.pyNA_directory + '/cases/' + self.settings.case_name + '/output/coloring_files/')</span>
        <span class="c1">#     self.settings.theta_flaps = self.settings.theta_flaps*1.001</span>
        <span class="c1">#     self.trajectory.setup(problem=self.problem, settings=self.settings, ac=self.ac, engine=self.engine, engine_mode='trajectory', control_optimization=control_optimization)</span>
        <span class="c1">#     self.trajectory.compute(problem=self.problem, settings=self.settings, ac=self.ac, run_driver=True, init_trajectory=None, control_optimization=control_optimization, objective=objective)</span>
        <span class="c1">#     converged = self.trajectory.check_convergence(settings=self.settings, filename='IPOPT_trajectory_convergence.out')</span>

        <span class="k">return</span> <span class="n">converged</span></div>

<div class="viewcode-block" id="pyna.compute_noise_time_series"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.compute_noise_time_series">[docs]</a>    <span class="k">def</span> <span class="nf">compute_noise_time_series</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Compute noise for a predefined trajectory.</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>

        <span class="c1"># Load aircraft and engine timeseries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">load_time_series</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">engine_file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">engine_file_name</span><span class="p">)</span>

        <span class="c1"># Load trajectory data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">load_time_series</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>

        <span class="c1"># Create noise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">coloring_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/cases/'</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">case_name</span> <span class="o">+</span> <span class="s1">'/coloring_files/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">setup_time_series</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">,</span> <span class="n">n_t</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">n_t</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'time_series'</span><span class="p">,</span> <span class="n">control_optimization</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">compute_time_series</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">time_series</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'time_series'</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="pyna.compute_noise_contours"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.compute_noise_contours">[docs]</a>    <span class="k">def</span> <span class="nf">compute_noise_contours</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_lst</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_lst</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Compute noise contours for a predefined trajectory.</span>

<span class="sd">        :param x_lst: List of x-location of the microphones.</span>
<span class="sd">        :type x_lst: list</span>
<span class="sd">        :param y_lst: List of y-location of the microphones.</span>
<span class="sd">        :type y_lst: list</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>

        <span class="c1"># Load aircraft and engine time series</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">load_time_series</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">engine_file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">engine_file_name</span><span class="p">)</span>

        <span class="c1"># Load trajectory data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">load_time_series</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>

        <span class="c1"># Get list of observers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">x_observer_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">x_lst</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">y_lst</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">cntr</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_lst</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x_lst</span><span class="p">):</span>
                <span class="n">cntr</span> <span class="o">=</span> <span class="n">cntr</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">x_observer_array</span><span class="p">[</span><span class="n">cntr</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">x_observer_array</span><span class="p">[</span><span class="n">cntr</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">x_observer_array</span><span class="p">[</span><span class="n">cntr</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="mf">0.3048</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">coloring_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/cases/'</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">case_name</span> <span class="o">+</span> <span class="s1">'/coloring_files/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">setup_time_series</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">,</span> <span class="n">n_t</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">n_t</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'time_series'</span><span class="p">,</span> <span class="n">control_optimization</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">compute_time_series</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">time_series</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'time_series'</span><span class="p">)</span>

        <span class="c1"># Extract the contour</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">contour</span><span class="p">[</span><span class="s1">'x_lst'</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_lst</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">contour</span><span class="p">[</span><span class="s1">'y_lst'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">y_lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="n">y_lst</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">contour</span><span class="p">[</span><span class="s1">'X'</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">contour</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">contour</span><span class="p">[</span><span class="s1">'x_lst'</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">contour</span><span class="p">[</span><span class="s1">'y_lst'</span><span class="p">])</span>

        <span class="c1"># Initialize contour solution matrix</span>
        <span class="n">epnl_contour</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">y_lst</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">x_lst</span><span class="p">)))</span>
        <span class="n">cntr</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_lst</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x_lst</span><span class="p">):</span>
                <span class="n">cntr</span> <span class="o">=</span> <span class="n">cntr</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">epnl_contour</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.'</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">levels_int_metric</span><span class="p">)[</span><span class="n">cntr</span><span class="p">]</span>

        <span class="c1"># Flip epnl solution matrix for negative y-values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">contour</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">levels_int_metric</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">epnl_contour</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]),</span> <span class="n">epnl_contour</span><span class="p">))</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="pyna.compute_noise_epnl_table"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.compute_noise_epnl_table">[docs]</a>    <span class="k">def</span> <span class="nf">compute_noise_epnl_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>

        <span class="sd">"""</span>
<span class="sd">        Compute table of epnl for individual noise sources and observers.</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>

        <span class="c1"># Set levels_int_metric to epnl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">levels_int_metric</span> <span class="o">=</span> <span class="s1">'epnl'</span>

        <span class="c1"># Initialize epnl</span>
        <span class="n">epnl_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">observer_lst</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

        <span class="c1"># Iterate over component list</span>
        <span class="n">components</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'fan_inlet'</span><span class="p">,</span> <span class="s1">'fan_discharge'</span><span class="p">,</span> <span class="s1">'core'</span><span class="p">,</span> <span class="s1">'jet_mixing'</span><span class="p">,</span> <span class="s1">'airframe'</span><span class="p">,</span> <span class="s1">'all_sources'</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">comp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">components</span><span class="p">):</span>

            <span class="c1"># Reset component flags</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">fan_inlet</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">fan_discharge</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">core</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">jet_mixing</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">jet_shock</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">airframe</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">all_sources</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># Enable component flag</span>
            <span class="k">if</span> <span class="n">comp</span> <span class="o">==</span> <span class="s1">'fan_inlet'</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">fan_inlet</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">comp</span> <span class="o">==</span> <span class="s1">'fan_discharge'</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">fan_discharge</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">comp</span> <span class="o">==</span> <span class="s1">'core'</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">core</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">comp</span> <span class="o">==</span> <span class="s1">'jet_mixing'</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">jet_mixing</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">comp</span> <span class="o">==</span> <span class="s1">'jet_shock'</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">jet_shock</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">comp</span> <span class="o">==</span> <span class="s1">'airframe'</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">airframe</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">comp</span> <span class="o">==</span> <span class="s1">'all_sources'</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">fan_inlet</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">fan_discharge</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">core</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">jet_mixing</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">jet_shock</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">airframe</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># Run pyNA</span>
            <span class="n">pyna</span><span class="o">.</span><span class="n">compute_noise_time_series</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

            <span class="c1"># Save solutions</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">observer_lst</span><span class="p">)):</span>
                <span class="n">epnl_table</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.epnl'</span><span class="p">)[</span><span class="n">j</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">epnl_table</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.epnl'</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Create data frame for solutions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">epnl_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">epnl_table</span><span class="p">)</span>
        <span class="n">observer_lst</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">observer_lst</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'take-off'</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">epnl_table</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">observer_lst</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">epnl_table</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">components</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">epnl_table</span></div>

<div class="viewcode-block" id="pyna.compute_noise_source_distribution"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.compute_noise_source_distribution">[docs]</a>    <span class="k">def</span> <span class="nf">compute_noise_source_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Compute noise source spectral and directional distribution.</span>

<span class="sd">        :param time_step: Time step in predefined trajectory at which to compute the noise source distribution.</span>
<span class="sd">        :type time_step: np.int64</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>

        <span class="c1"># Only implemented for python</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">language</span> <span class="o">==</span> <span class="s1">'julia'</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'This method has not yet been implemented in Julia. Set os.environ["language"]="python" and run again.'</span><span class="p">)</span>

        <span class="c1"># Load aircraft and engine time series</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">load_operating_point</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="n">time_step</span><span class="p">,</span> <span class="n">engine_file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">engine_file_name</span><span class="p">)</span>

        <span class="c1"># Load trajectory data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">load_operating_point</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="n">time_step</span><span class="p">)</span>

        <span class="c1"># Single observer setting; disable shielding</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">shielding</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Create noise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">coloring_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/cases/'</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">case_name</span> <span class="o">+</span> <span class="s1">'/coloring_files/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">setup_time_series</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">,</span> <span class="n">n_t</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">n_t</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'distribution'</span><span class="p">,</span> <span class="n">control_optimization</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">compute_time_series</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">time_series</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'distribution'</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="pyna.compute_trajectory_noise"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.compute_trajectory_noise">[docs]</a>    <span class="k">def</span> <span class="nf">compute_trajectory_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_traj_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Compute aircraft take-off trajectory and noise signature.</span>

<span class="sd">        :param init_traj_name: Name of initialization trajectory (in output folder of case).</span>
<span class="sd">        :type init_traj_name: str</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>

        <span class="c1"># Load aircraft and engine deck</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">load_aerodynamics</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">compute_characteristic_speeds</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">load_deck</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>

        <span class="c1"># Create initialization trajectory</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">init_traj_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">problem_init</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">coloring_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/cases/'</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">case_name</span> <span class="o">+</span> <span class="s1">'/coloring_files/'</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem_init</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">,</span> <span class="n">engine_mode</span><span class="o">=</span><span class="s1">'trajectory'</span><span class="p">,</span> <span class="n">control_optimization</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem_init</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">problem_init</span> <span class="o">=</span> <span class="n">pyna</span><span class="o">.</span><span class="n">load_results</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/cases/'</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">case_name</span> <span class="o">+</span> <span class="s1">'/output/'</span> <span class="o">+</span> <span class="n">init_traj_name</span><span class="p">,</span> <span class="s1">'final'</span><span class="p">)</span>

        <span class="c1"># Setup trajectory for noise computations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">n_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem_init</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.t_s'</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">coloring_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/cases/'</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">case_name</span> <span class="o">+</span> <span class="s1">'/coloring_files/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">,</span> <span class="n">engine_mode</span><span class="o">=</span><span class="s1">'noise'</span><span class="p">,</span> <span class="n">control_optimization</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">setup_trajectory_noise</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">,</span> <span class="n">n_t</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">n_t</span><span class="p">,</span> <span class="n">control_optimization</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Run the noise calculations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">,</span> <span class="n">run_driver</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">init_trajectory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem_init</span><span class="p">)</span>

        <span class="c1"># Check convergence</span>
        <span class="n">converged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">check_convergence</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">'IPOPT_Traj_init.out'</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">converged</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'Trajectory did not converge.'</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="pyna.optimize_trajectory_takeoff_noise"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.optimize_trajectory_takeoff_noise">[docs]</a>    <span class="k">def</span> <span class="nf">optimize_trajectory_takeoff_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_sideline</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">init_traj_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Compute aircraft take-off trajectory and noise signature.</span>

<span class="sd">        :param n_sideline: Number of sideline microphones to use in the control optimization</span>
<span class="sd">        :type n_sideline: int</span>
<span class="sd">        :param init_traj_name: Name of initialization trajectory (in output folder of case).</span>
<span class="sd">        :type init_traj_name: str</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>

        <span class="c1"># Load aircraft and engine deck</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">load_aerodynamics</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">compute_characteristic_speeds</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">load_deck</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>

        <span class="c1"># Create initialization trajectory</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">init_traj_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">problem_init</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">coloring_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/cases/'</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">case_name</span> <span class="o">+</span> <span class="s1">'/coloring_files/'</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem_init</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">,</span> <span class="n">engine_mode</span><span class="o">=</span><span class="s1">'trajectory'</span><span class="p">,</span> <span class="n">control_optimization</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem_init</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">problem_init</span> <span class="o">=</span> <span class="n">pyna</span><span class="o">.</span><span class="n">load_results</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/cases/'</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">case_name</span> <span class="o">+</span> <span class="s1">'/output/'</span> <span class="o">+</span> <span class="n">init_traj_name</span><span class="p">,</span> <span class="s1">'final'</span><span class="p">)</span>

        <span class="c1"># Get list of observers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">x_observer_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_sideline</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">x_observer_array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="n">n_sideline</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">x_observer_array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">450.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">x_observer_array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mf">0.3048</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">x_observer_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6500.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">x_observer_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">x_observer_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mf">0.3048</span>

        <span class="c1"># Setup trajectory for noise computations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">n_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem_init</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.t_s'</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">coloring_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/cases/'</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">case_name</span> <span class="o">+</span> <span class="s1">'/coloring_files/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">,</span> <span class="n">engine_mode</span><span class="o">=</span><span class="s1">'noise'</span><span class="p">,</span> <span class="n">control_optimization</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">setup_trajectory_noise</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">,</span> <span class="n">n_t</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">n_t</span><span class="p">,</span> <span class="n">control_optimization</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Run the trajectory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">,</span> <span class="n">run_driver</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">init_trajectory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">problem_init</span><span class="p">,</span> <span class="n">control_optimization</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Check convergence</span>
        <span class="n">converged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">check_convergence</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">'IPOPT_Traj_init.out'</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">converged</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'Trajectory did not converge.'</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="pyna.save_time_series"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.save_time_series">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">save_time_series</span><span class="p">(</span><span class="n">problem</span><span class="p">:</span> <span class="n">om</span><span class="o">.</span><span class="n">Problem</span><span class="p">,</span> <span class="n">settings</span><span class="p">:</span> <span class="n">Settings</span><span class="p">,</span> <span class="n">ac</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">path_save_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">engine_save_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Save a time_series solution of the trajectory calculations.</span>

<span class="sd">        :param problem: Openmdao probolem to save.</span>
<span class="sd">        :type problem: om.Problem</span>
<span class="sd">        :param settings: pyna settings</span>
<span class="sd">        :type settings: Settings</span>
<span class="sd">        :param ac: aircraft parameters</span>
<span class="sd">        :type ac: Aircraft</span>
<span class="sd">        :param path_save_name: name of the time_series path save file</span>
<span class="sd">        :type path_save_name: str</span>
<span class="sd">        :param engine_save_name: name of the time_series engine save file</span>
<span class="sd">        :type engine_save_name: str</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>

        <span class="c1"># Trajectory file</span>
        <span class="n">t_source</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.t_s'</span><span class="p">)</span>
        <span class="n">t_intp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t_source</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_source</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'t_source [s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_intp</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'X [m]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.x'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'Y [m]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.y'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'Z [m]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.z'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'V [m/s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.v'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'M_0 [-]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.M_0'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'F_n [N]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.F_n'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'TS [-]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.TS'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'c_0 [m/s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.c_0'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'T_0 [K]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.T_0'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'p_0 [Pa]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.p_0'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'rho_0 [kg/m3]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.rho_0'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'mu_0 [kg/ms]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.mu_0'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'I_0 [kg/m2s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.I_0'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'alpha [deg]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.alpha'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'gamma [deg]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.gamma'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'Airframe LG [-]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.I_landing_gear'</span><span class="p">))</span>
        <span class="n">path</span><span class="p">[</span><span class="s1">'Airframe delta_f [deg]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.theta_flaps'</span><span class="p">))</span>

        <span class="c1"># Engine file</span>
        <span class="n">engine</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">engine</span><span class="p">[</span><span class="s1">'t_source [s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_intp</span>
        <span class="n">engine</span><span class="p">[</span><span class="s1">'Ne [-]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="n">n_eng</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">core</span><span class="p">:</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Core mdot [kg/s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.mdoti_c'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Core Pt [Pa]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.Pti_c'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Core Tti [K]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.Tti_c'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Core Ttj [K]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.Ttj_c'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Core DT_t [K]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.DTt_des_c'</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Core mdot [kg/s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Core Pt [Pa]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Core Tti [K]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Core Ttj [K]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Core DT_t [K]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="n">engine</span><span class="p">[</span><span class="s1">'LPT rho_e [kg/m3]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="n">engine</span><span class="p">[</span><span class="s1">'LPT c_e [m/s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="n">engine</span><span class="p">[</span><span class="s1">'HPT rho_i [kg/m3]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="n">engine</span><span class="p">[</span><span class="s1">'HPT c_i [m/s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">jet_mixing</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">settings</span><span class="o">.</span><span class="n">jet_shock</span><span class="p">:</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet A [m2]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.A_j'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet rho [kg/m3]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.rho_j'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet Tt [K]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.Tt_j'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet V [m/s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.V_j'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet M [-]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">settings</span><span class="o">.</span><span class="n">jet_mixing</span> <span class="ow">and</span> <span class="n">settings</span><span class="o">.</span><span class="n">jet_shock</span><span class="p">:</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet A [m2]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.A_j'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet rho [kg/m3]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet Tt [K]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.Tt_j'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet V [m/s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.V_j'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet M [-]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.M_j'</span><span class="p">))</span>    
        <span class="k">elif</span> <span class="n">settings</span><span class="o">.</span><span class="n">jet_mixing</span> <span class="ow">and</span> <span class="n">settings</span><span class="o">.</span><span class="n">jet_shock</span><span class="p">:</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet A [m2]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.A_j'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet rho [kg/m3]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.rho_j'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet Tt [K]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.Tt_j'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet V [m/s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.V_j'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet M [-]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.M_j'</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet A [m2]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet rho [kg/m3]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet Tt [K]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet V [m/s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet M [-]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="n">engine</span><span class="p">[</span><span class="s1">'Jet delta [deg]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">airframe</span><span class="p">:</span>    
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Airframe LG [-]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.I_landing_gear'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Airframe delta_f [deg]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.theta_flaps'</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Airframe LG [-]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Airframe delta_f [deg]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">fan_inlet</span> <span class="ow">or</span> <span class="n">settings</span><span class="o">.</span><span class="n">fan_discharge</span><span class="p">:</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan mdot in [kg/s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.mdot_f'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan A [m2]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.A_f'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan d [m]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.d_f'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan N [rpm]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.N_f'</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan delta T [K]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t_intp</span><span class="p">,</span> <span class="n">t_source</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'engine.DTt_f'</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan mdot in [kg/s]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan A [m2]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan d [m]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan N [rpm]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
            <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan delta T [K]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan B [-]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="n">B_fan</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan V [-]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="n">V_fan</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan RSS [%]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="n">RSS_fan</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan IGV [-]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>
        <span class="n">engine</span><span class="p">[</span><span class="s1">'Fan ID [-]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t_intp</span><span class="p">))</span>

        <span class="c1"># Save data frames</span>
        <span class="n">path</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/cases/'</span> <span class="o">+</span> <span class="n">settings</span><span class="o">.</span><span class="n">case_name</span> <span class="o">+</span> <span class="s1">'/trajectory/'</span> <span class="o">+</span> <span class="n">path_save_name</span><span class="p">)</span>
        <span class="n">engine</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/cases/'</span> <span class="o">+</span> <span class="n">settings</span><span class="o">.</span><span class="n">case_name</span> <span class="o">+</span> <span class="s1">'/engine/'</span> <span class="o">+</span> <span class="n">engine_save_name</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="pyna.plot_trajectory"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.plot_trajectory">[docs]</a>    <span class="k">def</span> <span class="nf">plot_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">,</span> <span class="o">*</span><span class="n">problem_verify</span><span class="p">):</span>
        <span class="c1"># Check if problem_verify is empty</span>
        <span class="k">if</span> <span class="n">problem_verify</span><span class="p">:</span>
            <span class="n">verification</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">problem_verify</span> <span class="o">=</span> <span class="n">problem_verify</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">verification</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/utils/'</span> <span class="o">+</span> <span class="s1">'plot.mplstyle'</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.x'</span><span class="p">),</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.z'</span><span class="p">),</span> <span class="s1">'-o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Take-off trajectory module'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verification</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem_verify</span><span class="p">[</span><span class="s1">'X [m]'</span><span class="p">],</span> <span class="n">problem_verify</span><span class="p">[</span><span class="s1">'Z [m]'</span><span class="p">],</span> <span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'NASA STCA (Berton)'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'X [m]'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Z [m]'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'lower left'</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.t_s'</span><span class="p">),</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.v'</span><span class="p">),</span> <span class="s1">'-o'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verification</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem_verify</span><span class="p">[</span><span class="s1">'t_source [s]'</span><span class="p">],</span> <span class="n">problem_verify</span><span class="p">[</span><span class="s1">'V [m/s]'</span><span class="p">],</span> <span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'NASA STCA (Berton)'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'t [s]'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$v$ [m/s]'</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.t_s'</span><span class="p">),</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">1000.</span> <span class="o">*</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.F_n'</span><span class="p">),</span> <span class="s1">'-o'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verification</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem_verify</span><span class="p">[</span><span class="s1">'t_source [s]'</span><span class="p">],</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">1000.</span> <span class="o">*</span> <span class="n">problem_verify</span><span class="p">[</span><span class="s1">'F_n [N]'</span><span class="p">],</span> <span class="s1">'--'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'t [s]'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$F_n$ [kN]'</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.t_s'</span><span class="p">),</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.TS'</span><span class="p">),</span> <span class="s1">'-o'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verification</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem_verify</span><span class="p">[</span><span class="s1">'t_source [s]'</span><span class="p">],</span> <span class="n">problem_verify</span><span class="p">[</span><span class="s1">'TS [-]'</span><span class="p">],</span> <span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'NASA STCA (Berton)'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'t [s]'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$TS$ [-]'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.t_s'</span><span class="p">),</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.alpha'</span><span class="p">),</span> <span class="s1">'-o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$\alpha$'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.t_s'</span><span class="p">),</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.gamma'</span><span class="p">),</span> <span class="s1">'-o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$\gamma$'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verification</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem_verify</span><span class="p">[</span><span class="s1">'t_source [s]'</span><span class="p">],</span> <span class="n">problem_verify</span><span class="p">[</span><span class="s1">'alpha [deg]'</span><span class="p">],</span> <span class="s1">'--'</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem_verify</span><span class="p">[</span><span class="s1">'t_source [s]'</span><span class="p">],</span> <span class="n">problem_verify</span><span class="p">[</span><span class="s1">'gamma [deg]'</span><span class="p">],</span> <span class="s1">'--'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'t [s]'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\alpha, \gamma$ [deg]'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.t_s'</span><span class="p">),</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.theta_flaps'</span><span class="p">),</span> <span class="s1">'-o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$\theta_</span><span class="si">{flaps}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.t_s'</span><span class="p">),</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'trajectory.theta_slats'</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">'-o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$\theta_</span><span class="si">{slats}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verification</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">problem_verify</span><span class="p">[</span><span class="s1">'t_source [s]'</span><span class="p">],</span> <span class="n">problem_verify</span><span class="p">[</span><span class="s1">'Airframe delta_f [deg]'</span><span class="p">],</span> <span class="s1">'--'</span><span class="p">)</span>
            <span class="c1"># ax[2,1].plot(problem_verify['t_source [s]'], problem_verify['Airframe delta_s [deg]'], '--')</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'t [s]'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\theta$ [deg]'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">28</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
 
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="pyna.load_results"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.load_results">[docs]</a>    <span class="k">def</span> <span class="nf">load_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">case_name</span><span class="o">=</span><span class="s1">'final'</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Load model .sql results file.</span>

<span class="sd">        :param file_name: Name of the .sql results file to load.</span>
<span class="sd">        :type file_name: str</span>
<span class="sd">        :param case_name: Name of the case to load in the results-file.</span>
<span class="sd">        :type case_name: str</span>

<span class="sd">        :return: results</span>
<span class="sd">        """</span>

        <span class="c1"># Create case reader</span>
        <span class="n">cr</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">CaseReader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/cases/'</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">case_name</span> <span class="o">+</span> <span class="s1">'/output/'</span> <span class="o">+</span> <span class="n">file_name</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">get_case</span><span class="p">(</span><span class="n">case_name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">results</span></div>

<div class="viewcode-block" id="pyna.plot_noise_time_series"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.plot_noise_time_series">[docs]</a>    <span class="k">def</span> <span class="nf">plot_noise_time_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Plot the noise metric along the trajectory.</span>

<span class="sd">        :param metric: noise metric to plot. Specify 'pnlt' or 'oaspl'/</span>
<span class="sd">        :type metric: str</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>

        <span class="c1"># Create figure</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">observer_lst</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mf">4.3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">ax_zoom</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/utils/'</span> <span class="o">+</span> <span class="s1">'plot.mplstyle'</span><span class="p">)</span>

        <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">magma</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

        <span class="c1"># Iterate over observer locations</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">observer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">observer_lst</span><span class="p">):</span>

            <span class="c1"># Time range of epnl domain of dependence</span>
            <span class="n">time_epnl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.t_o'</span><span class="p">)[</span><span class="n">i</span><span class="p">,:][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.pnlt'</span><span class="p">)[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.pnlt'</span><span class="p">)[</span><span class="n">i</span><span class="p">,:])</span> <span class="o">-</span> <span class="mf">10.</span><span class="p">)]</span>

            <span class="c1"># Plot noise levels</span>
            <span class="k">if</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">'pnlt'</span><span class="p">:</span>
                <span class="c1"># Plot noise levels</span>
                <span class="k">if</span> <span class="n">observer</span> <span class="o">==</span> <span class="s1">'lateral'</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.t_o'</span><span class="p">)[</span><span class="n">i</span><span class="p">,:</span><span class="mi">180</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.pnlt'</span><span class="p">)[</span><span class="n">i</span><span class="p">,:</span><span class="mi">180</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'pyNA'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.t_o'</span><span class="p">)[</span><span class="n">i</span><span class="p">,:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.pnlt'</span><span class="p">)[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'pyNA'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="n">time_epnl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">time_epnl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">105</span><span class="p">,</span> <span class="mi">105</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s1">'EPNL domain of dependence'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">validation</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load_trajectory_verification_data</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">verification_trajectory</span><span class="p">[</span><span class="n">observer</span><span class="p">][</span><span class="s1">'t observer [s]'</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">verification_trajectory</span><span class="p">[</span><span class="n">observer</span><span class="p">][</span><span class="s1">'PNLT'</span><span class="p">],</span> <span class="s1">'--'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'NASA STCA (Berton)'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Time after brake release [s]'</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">105</span><span class="p">])</span>

                <span class="c1"># Zoomed-in plots</span>
                <span class="n">ax_zoom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">zoomed_inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'lower right'</span><span class="p">)</span>
                <span class="n">ax_zoom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.t_o'</span><span class="p">)[</span><span class="n">i</span><span class="p">,:</span><span class="mi">180</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.pnlt'</span><span class="p">)[</span><span class="n">i</span><span class="p">,:</span><span class="mi">180</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">validation</span><span class="p">:</span>
                    <span class="n">ax_zoom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">verification_trajectory</span><span class="p">[</span><span class="n">observer</span><span class="p">][</span><span class="s1">'t observer [s]'</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">verification_trajectory</span><span class="p">[</span><span class="n">observer</span><span class="p">][</span><span class="s1">'PNLT'</span><span class="p">],</span> <span class="s1">'--'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">ax_zoom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
                <span class="n">ax_zoom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
                <span class="n">ax_zoom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">time_epnl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">time_epnl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
                <span class="n">ax_zoom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.pnlt'</span><span class="p">)[</span><span class="n">i</span><span class="p">,:])</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.pnlt'</span><span class="p">)[</span><span class="n">i</span><span class="p">,:])</span><span class="o">+</span><span class="mf">1.5</span><span class="p">])</span>
                <span class="n">mark_inset</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ax_zoom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">loc1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">loc2</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>                

            <span class="k">elif</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">'oaspl'</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.t_o'</span><span class="p">)[</span><span class="n">i</span><span class="p">,:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.oaspl'</span><span class="p">)[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'pyNA'</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$OASPL_{'</span> <span class="o">+</span> <span class="n">observer</span> <span class="o">+</span> <span class="s1">'}$ [dB]'</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">validation</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load_trajectory_verification_data</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">verification_trajectory</span><span class="p">[</span><span class="n">observer</span><span class="p">][</span><span class="s1">'t observer [s]'</span><span class="p">],</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">verification_trajectory</span><span class="p">[</span><span class="n">observer</span><span class="p">][</span><span class="s1">'OASPL'</span><span class="p">],</span> <span class="s1">'--'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s1">'NASA STCA (Berton)'</span><span class="p">)</span>

            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Time after brake release [s]'</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">105</span><span class="p">])</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Lateral'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Flyover'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$PNLT$ [PNdB]'</span><span class="p">)</span>

        <span class="c1"># Set legend</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'lower left'</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.09</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="pyna.plot_noise_contours"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.plot_noise_contours">[docs]</a>    <span class="k">def</span> <span class="nf">plot_noise_contours</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Plot noise contours around take-off trajectory.</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>

        <span class="c1"># This custom formatter removes trailing zeros, e.g. "1.0" becomes "1", and then adds a percent sign.</span>
        <span class="k">def</span> <span class="nf">fmt</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">"</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"0"</span><span class="p">):</span>
                <span class="n">s</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">"</span>
            <span class="k">return</span> <span class="sa">rf</span><span class="s2">"</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">"</span> <span class="k">if</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"text.usetex"</span><span class="p">]</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">"</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/utils/'</span> <span class="o">+</span> <span class="s1">'plot.mplstyle'</span><span class="p">)</span>

        <span class="n">CS</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">contour</span><span class="p">[</span><span class="s1">'X'</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">contour</span><span class="p">[</span><span class="s1">'Y'</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">contour</span><span class="p">[</span><span class="s1">'epnl'</span><span class="p">],</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="s1">'X [m]'</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="s1">'Y [m]'</span><span class="p">],</span> <span class="s1">'k-'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Trajectory'</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">],</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">contour</span><span class="p">[</span><span class="s1">'X'</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">contour</span><span class="p">[</span><span class="s1">'X'</span><span class="p">])])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'X [m]'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Z [m]'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="pyna.plot_noise_source_distribution"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.plot_noise_source_distribution">[docs]</a>    <span class="k">def</span> <span class="nf">plot_noise_source_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">metric</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">components</span><span class="p">:</span><span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Plot noise hemispheres </span>
        <span class="k">if</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">'spl'</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">'projection'</span><span class="p">:</span> <span class="s1">'polar'</span><span class="p">},</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=-</span><span class="mf">0.</span><span class="p">,</span><span class="n">hspace</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">'oaspl'</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Invalid metric specified. Specify: spl / oaspl.'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pyNA_directory</span> <span class="o">+</span> <span class="s1">'/utils/'</span> <span class="o">+</span> <span class="s1">'plot.mplstyle'</span><span class="p">)</span>

        <span class="c1"># Initialize pyna</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">validation</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load_source_verification_data</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">)</span>

        <span class="c1"># Loop through different components</span>
        <span class="n">irow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">icol</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">comp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">components</span><span class="p">):</span>

            <span class="c1"># Enable component in pyna settings</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">all_sources</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">fan_inlet</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">fan_discharge</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">core</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">jet_mixing</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">jet_shock</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">airframe</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">core</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">jet_mixing</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">airframe</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">fan_inlet</span> <span class="o">=</span> <span class="kc">True</span>        
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">fan_discharge</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># Determine row and column in plot</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">irow</span> <span class="o">=</span> <span class="n">irow</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">icol</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">icol</span> <span class="o">=</span> <span class="n">icol</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Core'</span><span class="p">,</span> <span class="s1">'Jet mixing'</span><span class="p">,</span> <span class="s1">'Airframe'</span><span class="p">,</span> <span class="s1">'Fan inlet'</span><span class="p">,</span> <span class="s1">'Fan discharge'</span><span class="p">]</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pad</span><span class="o">=-</span><span class="mi">60</span><span class="p">)</span>

            <span class="c1"># Run noise source distribution</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_noise_source_distribution</span><span class="p">(</span><span class="n">time_step</span><span class="o">=</span><span class="n">time_step</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">'spl'</span><span class="p">:</span>
                <span class="c1"># Plot frequencies </span>
                <span class="n">ci</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">k_plot</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">23</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">k_plot</span><span class="p">)):</span>
                    <span class="n">ci</span> <span class="o">=</span> <span class="n">ci</span> <span class="o">+</span> <span class="mi">1</span>

                    <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">set_thetamin</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">set_thetamax</span><span class="p">(</span><span class="mi">180</span><span class="p">)</span>

                    <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">magma</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">irow</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">icol</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">validation</span><span class="p">:</span>
                            <span class="n">data_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">verification_source_supp</span><span class="p">[</span><span class="n">comp</span><span class="p">][</span><span class="mi">26</span> <span class="o">*</span> <span class="n">time_step</span> <span class="p">:</span> <span class="mi">26</span> <span class="o">*</span> <span class="p">(</span><span class="n">time_step</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
                            <span class="n">data_val</span> <span class="o">=</span> <span class="n">data_val</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">:]</span>
                            <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="o">*</span><span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">data_val</span><span class="p">[</span><span class="n">k_plot</span><span class="p">[</span><span class="n">k</span><span class="p">],:],</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">ci</span><span class="p">])</span>
                        <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="o">*</span><span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.spl'</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">k_plot</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">ci</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'$f = $'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="n">k_plot</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">/</span><span class="mf">1000.</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="s1">' $kHz$'</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">validation</span><span class="p">:</span>
                            <span class="n">data_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">verification_source_supp</span><span class="p">[</span><span class="n">comp</span><span class="p">][</span><span class="mi">26</span> <span class="o">*</span> <span class="n">time_step</span> <span class="p">:</span> <span class="mi">26</span> <span class="o">*</span> <span class="p">(</span><span class="n">time_step</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
                            <span class="n">data_val</span> <span class="o">=</span> <span class="n">data_val</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">:]</span>
                            <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="o">*</span><span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">data_val</span><span class="p">[</span><span class="n">k_plot</span><span class="p">[</span><span class="n">k</span><span class="p">],:],</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">ci</span><span class="p">])</span>        
                        <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="o">*</span><span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.spl'</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">k_plot</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">ci</span><span class="p">])</span>

                <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">60</span><span class="p">,</span> <span class="mi">150</span><span class="p">])</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">135</span><span class="p">,</span><span class="mi">180</span><span class="p">]))</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">60</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">150</span><span class="p">])</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'SPL [dB]'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">0.93</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">'oaspl'</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">validation</span><span class="p">:</span>
                    <span class="n">data_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">verification_source_supp</span><span class="p">[</span><span class="n">comp</span><span class="p">][</span><span class="mi">26</span> <span class="o">*</span> <span class="n">time_step</span> <span class="p">:</span> <span class="mi">26</span> <span class="o">*</span> <span class="p">(</span><span class="n">time_step</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">data_val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:],</span> <span class="s1">'o'</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">'noise.oaspl'</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>

                <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\theta$ [deg]'</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'OASPL [dB]'</span><span class="p">)</span>

        <span class="c1"># Set legend</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">'k-'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'pyNA'</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">validation</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'NASA STCA (Berton)'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">'spl'</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'lower left'</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'lower left'</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.035</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Turn off the unused frames</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="pyna.plot_optimizer_convergence_data"><a class="viewcode-back" href="../../pyNA.html#pyNA.pyna.pyna.plot_optimizer_convergence_data">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">plot_optimizer_convergence_data</span><span class="p">(</span><span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Plot the convergence data of the optimization across iterates.</span>

<span class="sd">        :param file_name: name of the IPOPT output file</span>
<span class="sd">        :type file_name: str</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>

        <span class="c1"># Read the IPOPT output file line by line</span>
        <span class="n">myfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">'rt'</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="s1">'iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls</span><span class="se">\n</span><span class="s1">'</span>

        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># Get next line from file</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">myfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

            <span class="c1"># if line is empty: end of file is reached</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="c1"># Look for iteration number</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[:</span><span class="mi">4</span><span class="p">]:</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="c1"># Remove r from the iteration line</span>
                <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'f'</span><span class="p">,</span> <span class="s1">'F'</span><span class="p">,</span> <span class="s1">'h'</span><span class="p">,</span> <span class="s1">'H'</span><span class="p">,</span> <span class="s1">'k'</span><span class="p">,</span> <span class="s1">'K'</span><span class="p">,</span> <span class="s1">'n'</span><span class="p">,</span> <span class="s1">'N'</span><span class="p">,</span> <span class="s1">'R'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">,</span> <span class="s1">'s'</span><span class="p">,</span> <span class="s1">'t'</span><span class="p">,</span> <span class="s1">'T'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>

                <span class="c1"># ADd line to data file</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">+</span> <span class="n">line</span>

        <span class="c1"># Close the file</span>
        <span class="n">myfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># Write the file in csv format and convert to pandas data frame</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Plot</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">font_size</span> <span class="o">=</span> <span class="mi">14</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'iter'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'objective'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Iterations'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Objective'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'iter'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'inf_pr'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'inf_pr'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'iter'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'inf_du'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'inf_du'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Iterations'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Infeasibility'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'lower left'</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'iter'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'lg(mu)'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'$log(\mu)$'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Iterations'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Barrier parameter'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'lower left'</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'iter'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'||d||'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Iterations'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'||d||'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'iter'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'alpha_pr'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'alpha_pr'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">'iter'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">'alpha_du'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'alpha_du'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'lower left'</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                        <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Iterations'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Stepsize'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

        <span class="k">return</span> <span class="kc">None</span></div></div>

</pre></div>
      </article>
      <footer>
        
        <div class="related-pages">
          
          
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Laurens Voet
            |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </main>
</div>
  </body>
</html>